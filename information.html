<!doctype html>
<!--
	Jericho Comms - Information-theoretically secure communications
	Copyright (c) 2013-2015  Joshua M. David

	This program is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation in version 3 of the License.

	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with this program.  If not, see [http://www.gnu.org/licenses/].
-->
<html lang="en">
	<head>
		<title>Jericho Comms&trade; - Technical design</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">		
		<meta name="description" content="Jericho Comms is a secure group chat program using one-time pads.">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="css/reset.css" type="text/css">
		<link rel="stylesheet" href="css/global.css" type="text/css">
		<link rel="stylesheet" href="css/print.css" type="text/css" media="print">
		
		<!--[if IE]>
			<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<![endif]-->		
		<!--[if IE 7]>
			<link rel="stylesheet" href="css/ie7.css" type="text/css">
		<![endif]-->
		<!--[if IE 8]>
			<link rel="stylesheet" href="css/ie8.css" type="text/css">
		<![endif]-->
	</head>
	<body>
		<div class="topSection">
			<div class="topBanner">
				<a class="logo" href="index.html" title="Homepage"></a>			
				<div class="mainNav">
					<ul>						
						<li><a href="information.html">Technical design</a></li>
						<li><a href="https://github.com/joshua-m-david/jerichoencryption">Source code</a></li>
						<li><a href="download.html">Download</a></li>
						<li><a href="installation.html">How to install</a></li>
						<li><a href="usage.html">How to use</a></li>
						<li><a href="faq.html">FAQ</a></li>			
					</ul>
				</div>
			</div>
		</div>
		<div class="content">
			<div class="page infoPage">
				<div class="information">
					<h1 class="nonPrintable">Technical design</h1>
					<p class="nonPrintable">
						This page is printable and can be downloaded as a 
						<a href="files/jericho-v1.5.1.pdf">PDF white paper</a><sup><a href="files/jericho-v1.5.1.pdf.asc">[sig]</a></sup>.
					</p>
					
					
					<div class="printableHeader printable">
						<div class="title">Jericho Comms&trade;</div>
						<div class="version">Version 1.5.1</div>
						<div class="date">24 December 2015</div>
						<div class="author">Joshua M. David</div>
                        <div class="email">joshua.m.david [at] tutanota.de</div>
					</div>
					<div class="printableAbstract">
						<h2 id="abstract"><span>1</span> Abstract</h2>						
						<p>
							This document describes the design of an encrypted group text communications program 
							which provides <a href="#ref25">information-theoretic security<sup>[25]</sup></a> for all 
							messages that are sent and received.
							
							The goal is to deliver a high assurance, encrypted communications program with 
							<a href="#ref34">plausible deniability<sup>[34]</sup></a> for activists, human rights lawyers, 
							journalists, whistleblowers and citizens of the world that need high assurances that their 
							communications are free of censorship, control and eavesdropping from the world's 
							governments and intelligence agencies.
							
							To defeat the world's top intelligence agencies, citizens of every country need to raise 
							their communications security to a level where no-one can ever hope to break the encryption, 
							regardless of advances in computing power, cryptanalysis, mathematics or quantum physics.
						</p>
						<p>
							To accomplish this goal, the program uses a 
							<a href="#ref22">True Random Number Generator<sup>[22]</sup></a> (TRNG), the 
							<a href="#ref23">One-Time Pad<sup>[23]</sup></a> (OTP) cipher for message encryption 
							and a one-time <a href="#ref24">Message Authentication Code<sup>[24]</sup></a> (MAC) for 
							message authenticity.
							
							To provide additional protection of the one-time pad database during the 
							<a href="#ref26">initial key exchange<sup>[26]</sup></a> between users, a 
							strong <a href="#ref27">password/passphrase<sup>[27]</sup></a> and 
							<a href="#ref66">keyfile<sup>[66]</sup></a> can be used. The program will then use a cascade 
							of password <a href="#ref28">Key Derivation Functions<sup>[28]</sup></a> (KDFs), 
							<a href="#ref29">stream ciphers<sup>[29]</sup></a> and MACs to encrypt and authenticate the 
							database.
							
							Other features of the program include a strong MAC for authentication between the clients 
							and the server, a decoy messaging system to frustrate 
							<a href="#ref65">traffic analysis<sup>[65]</sup></a> and a self 
							destruct mechanism which can wipe all the client databases in case of an emergency.
						</p>
						<p>
							One-time pads are not frequently used outside of government and military networks because 
							they are somewhat inconvenient to use. This means they have generally only been reserved for 
							truly important communications such as the 
							<a href="#ref64">highest-level Allied communications in World War II<sup>[64]</sup></a> 
							or the <a href="#ref30">Washington-Moscow hotline<sup>[30]</sup></a>.
							
							The main problems are that you need to collect a lot of truly random data and the one-time 
							pads must be exchanged through a secure channel (e.g. delivered in person) before 
							communication can take place. These are not insurmountable problems and the design of this 
							software solves the main issues which make using one-time pads too impractical. The whole 
							system is very simple to set up and use, including generating truly random key material, 
							exchanging the one-time pads securely, key management and communicating securely.
							
							The program itself can be <a href="#ref31">downloaded from the project's website<sup>[31]</sup></a> 
							and the full source code, which is available on <a href="#ref32">GitHub<sup>[32]</sup></a>, 
							is released under the <a href="#ref33">General Public License Version 3.0<sup>[33]</sup></a>.
						</p>
					</div>
					
					
					<h2 id="table-of-contents">Contents</h2>
					<div class="tableOfContents whitepaper">
						<ol>
							<li><a href="#abstract">Abstract</a></li>
							<li><a href="#introduction">Introduction</a></li>
							<li><a href="#notation">Formulas and notation</a></li>
							<li><a href="#overall-network-architecture">Overall network architecture</a></li>
							<li><a href="#how-it-works">How it works</a></li>
							<li><a href="#configuring-own-server">Server configuration</a></li>
							<li>
								<a href="#server-authentication-protocol">Server authentication protocol</a><br>
								<ol class="singleNumber">
									<li><a href="#design-goals">Design goals</a></li>
									<li><a href="#limitations">Limitations</a></li>
									<li><a href="#initial-setup">Initial setup</a></li>
									<li><a href="#send-and-verify-api-request">Client API request</a></li>
									<li><a href="#server-api-response">Server API response</a></li>
								</ol>
							</li>
							<li><a href="#frustrating-traffic-analysis">Preventing information leakage and traffic analysis</a></li>
							<li><a href="#using-tls">Using TLS/HTTPS</a></li>
							<li><a href="#trng-custom">User Chosen TRNG</a></li>
							<li>
								<a href="#trng-photo">Included Photo Based TRNG</a>
								<ol>
									<li><a href="#quality-photo-selection">Selecting a quality photograph</a></li>
									<li><a href="#photo-processing-algorithm">TRNG photo processing algorithm</a></li>
									<li><a href="#output-testing">Testing the TRNG random output</a></li>
									<li><a href="#trng-test-analysis">TRNG tests and analysis</a></li>
								</ol>
							</li>
							<li><a href="#pad-storage-export">Pad storage and exporting data</a></li>
							<li>
								<a href="#database-encryption">One-time pad database encryption and authentication</a>
								<ol>
									<li><a href="#cascade-database-encryption">Cascade database encryption</a></li>
									<li><a href="#cascade-database-authentication">Cascade database authentication</a></li>
									<li><a href="#database-index-authentication">Database index authentication</a></li>
								</ol>
							</li>
							<li>
								<a href="#database-key-wrapping">Protection of database encryption and authentication keys</a>
								<ol>
									<li><a href="#database-pbkdf">Database master key derivation</a></li>
									<li><a href="#subkey-derivation">Sub key derivation</a></li>
									<li><a href="#encryption-and-authentication-of-database-keys">Encryption and authentication of database keys</a></li>
								</ol>
							</li>												
							<li><a href="#using-html5">Using HTML5</a></li>
							<li>
								<a href="#json-rest-api">REST API using JSON</a>
								<ol>
									<li><a href="#api-send-message">Send message</a></li>
									<li><a href="#api-send-message-response">Send message server response</a></li>
									<li><a href="#api-receive-messages">Receive messages request</a></li>
									<li><a href="#api-receive-messages-response">Receive messages response</a></li>
									<li><a href="#api-auto-nuke">Initiate self destruct request</a></li>
									<li><a href="#api-auto-nuke-response">Self destruct initiated response</a></li>
								</ol>
							</li>
							<li><a href="#message-encoding">Message encoding</a></li>
							<li><a href="#encryption-process">Message encryption process</a></li>
							<li><a href="#decryption-process">Message decryption process</a></li>
							<li><a href="#message-authentication">Message authentication code (MAC)</a></li>
							<li><a href="#failsafe-csprng">Failsafe CSPRNG</a></li>
							<li><a href="#auto-nuke-process">Self destruct process</a></li>
							<li><a href="#extra-security-considerations">Extra security considerations</a></li>
							<li><a href="#references">References</a></li>
						</ol>
					</div>
					
					
					<h2 id="introduction"><span>2</span> Introduction</h2>
					<p>
						In the wake of the <a href="#ref1">global surveillance disclosures<sup>[1]</sup></a> it has 
						become apparent that the majority of our computer systems and communications are no longer secure. The 
						<a href="#ref2">NSA<sup>[2]</sup></a> and its spy agency partners are actively 
						<a href="#ref3">collecting<sup>[3]</sup></a> and 
						<a href="#ref4">storing<sup>[4]</sup></a> 
						the whole world's communications as it transits their networks. Any data passing through 
						the <a href="#ref5">Five Eyes<sup>[5]</sup></a> and partner countries (Australia, 
						Belgium, Canada, Denmark, France, Germany, Italy, Japan, the Netherlands, New Zealand, Norway, 
						Singapore, Spain, South Korea, Sweden, United Kingdom and United States) is intercepted, 
						collected, decrypted and stored indefinitely. Internet traffic, phone calls, email, chat 
						messages and everything else are vulnerable to this international surveillance network. 
						<a href="#ref6">Edward Snowden describes<sup>[6]</sup></a> this network:
					</p>
					<cite>
						"The Five Eyes alliance is sort of an artifact of the post World War II era where the Anglophone 
						countries are the major powers banded together to sort of co-operate and share the costs of 
						intelligence gathering infrastructure... The result of this was over decades and decades some 
						sort of a supra-national intelligence organisation that doesn't answer to the laws of its own 
						countries."						
					</cite>
					<p>
						This spy network is a massive breach of international human rights and it is an attack on 
						the liberty, freedom and privacy of every person on the planet. It has huge implications 
						for democracy, freedom of the press, attorney-client privilege and freedom of speech. The 
						<a href="#ref7">Universal Declaration of Human Rights<sup>[7]</sup></a> states clearly:
					</p>
					<cite>
						<b>Article 3:</b> Everyone has the right to life, liberty and security of person.
					</cite>
					<cite>
						<b>Article 12:</b> No one shall be subjected to arbitrary interference with his privacy, 
						family, home or correspondence, nor to attacks upon his honour and reputation. Everyone has the 
						right to the protection of the law against such interference or attacks.
					</cite>
					<p>
						From the NSA leaks we know some of the NSA's capabilities for interception, collection, 
						<a href="#ref8">malware, hacking<sup>[8]</sup></a> and 
						<a href="#ref9">interdiction<sup>[9]</sup></a>. 
						However we know very little about the NSA's full cryptanalytic capability from the NSA leaks. 
						It is classed as <a href="#ref10">Exceptionally Compartmented Information (ECI)<sup>[10]</sup></a>, 
						which very few people have access to within the NSA. In other words, the information is available 
						only on a need to know basis. We can assume this is likely only their top cryptanalysts and 
						agency directors. This is similar to how the Enigma cipher was broken but the 
						knowledge of this was known only to a few and 
						<a href="#ref11">kept secret for decades afterwards<sup>[11]</sup></a>. 
						Unfortunately Snowden did not have access to all their cryptanalytic capabilities 
						so we do not know what the NSA's true code breaking abilities are and which ciphers they 
						can break. <a href="#ref12">Edward Snowden once stated<sup>[12]</sup></a>:
					</p>
					<cite>
						"Encryption works. Properly implemented strong crypto systems are one of the few things that 
						you can rely on."
					</cite>
					<p>
						However no-one can actually qualify that statement to say <i>which</i> encryption is actually 
						strong and which is not. Snowden never had access to the highly sensitive, compartmentalised 
						information at the NSA in the first place. We are also unsure about which standards that the 
						NSA have compromised or weakened. We know that the 
						<a href="#ref13">Dual EC DRBG standard<sup>[13]</sup></a> and the 
						<a href="#ref14">NIST curves<sup>[14]</sup></a> appear very	suspect. However through their 
						control and manipulation of the <a href="#ref15">NIST<sup>[15]</sup></a> and 
						<a href="#ref16">IETF<sup>[16]</sup></a> standards it is entirely 
						possible that most public domain cryptography has been subtly influenced, weakened or corrupted to 
						some degree. To be protected from the NSA, it makes sense to take a conservative approach and 
						trust no single algorithm on its own. This means at a minimum using 
						<a href="#ref17">cascading ciphers and algorithms<sup>[17]</sup></a> to hedge against 
						the NSA exploiting flaws in the algorithms that 
						<a href="#ref18">only they know about<sup>[18]</sup></a>. In addition 
						to this it is important to use algorithms and best-practice knowledge from independent, reputable 
						cryptographers and security experts with no affiliation to the US government. It is even better if 
						these cryptographers are vocal with their criticisms about surveillance and government overreach such as 
						<a href="#ref19">Daniel J. Bernstein<sup>[19]</sup></a> or 
						<a href="#ref20">Bruce Schneier<sup>[20]</sup></a> so you can be assured they are not likely to 
						intentionally backdoor their algorithms.
					</p>
					<p>
						The main problem with public key cryptosystems currently in common use is that they are particularly 
						<a href="#ref35">vulnerable to quantum computers<sup>[35]</sup></a>. We know that the NSA are 
						<a href="#ref36">close to building one<sup>[36]</sup></a>. They will not make a public 
						announcement when they do get one and they may get one well before they become publicly 
						available especially with their large budget of 
						<a href="#ref37">$1 Billion per annum for cryptanalysis and exploitation services<sup>[37]</sup></a>.
						An <a href="#ref38">announcement from the NSA<sup>[38]</sup></a> in September 2015 has 
						recommended a plan to transition to quantum resistant algorithms in the very near future. Some 
						argue that this is a hint that they consider RSA or Elliptic Curve cryptography is   
						<a href="#ref39">no longer safe to use<sup>[39]</sup></a><a href="#ref40"><sup>[40]</sup></a>. Even 
						with quantum safe public key algorithms there is no general consensus about 
						which algorithms are actually secure against quantum computers or what key sizes will be 
						sufficient. A lot more public cryptanalysis and research in the area of post quantum cryptography 
						really needs to be done before this becomes a viable option. 
						A <a href="#ref21">2008 paper<sup>[21]</sup></a> proposed a 
						large key size of 7,667,855 bits for a hypothetical 256 bit security level when using the 
						<a href="#ref41">McEliece cryptosystem<sup>[41]</sup></a>. Comparing that security level to the 
						design of this program and given an equal 7,667,855 bits of truly random data, this program 
						would split the data into separate one-time pads of 1536 bits each, achieving perfect secrecy 
						for 4992 chat messages at 115 bytes of plaintext per message. This is essentially a years worth 
						of communication with another person but you get proven information-theoretic security instead 
						of an unproven scheme.
					</p>
					<p>
						Another problem with public key cryptography is that if you want to do it securely, users 
						need to meet and verify public key fingerprints in person. Verifying by voice over the phone 
						was once recommended, but <a href="#ref42">new research has shown<sup>[42]</sup></a> that given 
						a few audio samples of someone's voice, an attacker can use software that automates speech 
						synthesis to create a close duplicate of an individual's voice. The technology can then 
						transform the attacker's voice to say any message in the voice of the victim. With the 
						NSA in a privileged position on the Internet backbone, they could replace any  
						public key fetched over the Internet with one of their choosing using 
						<a href="#ref43">QUANTUMINSERT<sup>[43]</sup></a>. For example, if a source calls a journalist 
						to confirm the fingerprint of the public key they downloaded, the NSA can use voice synthesis 
						to confirm the fingerprint of the NSA's public key instead. With the source now encrypting to 
						the NSA's public key, this would allow the NSA to transparently perform a 
						<a href="#ref44">Man in the Middle attack<sup>[44]</sup></a> (MITM) on future communications 
						between the source and the journalist.
					</p>
					<p>
						Other methods of public key verification simply offload the trust responsibility to some other 
						mechanism, for example Certificate Authorities 
						<a href="#ref45">which have a multitude of problems<sup>[45]</sup></a><a href="#ref46"><sup>[46]</sup></a><a href="#ref47"><sup>[47]</sup></a> 
						and are not considered secure against nation state adversaries.
						If users need to meet physically to manually compare fingerprints to achieve reasonable security, 
						then it is no less difficult to exchange a memory card full of one-time pads instead which would 
						allow communication for years into the future with perfect secrecy.
						
						With one-time pads, there is no fear, uncertainty or doubt about which algorithms are safe, which 
						key sizes are sufficient and which algorithms are truly safe from quantum computers. Users can 
						focus on operational security which is something they can control, rather than relying on 
						unproven cryptographic algorithms and hoping that they are sufficiently secure against an 
						adversary such as the NSA. With one-time pads a whole class of cryptanalytic 
						attacks is ruled out completely.
					</p>
					
                    <h2 id="notation"><span>3</span> Formulas and notation</h2>
					<p>
						The notation used in this document will use limited mathematical and cryptographic 
                        formulas and will tend towards explaining the design in plain English rather than mathematical 
                        formulas so that the content is more accessible and understandable by a wider audience.
					</p>
                    <table class="formulas notation">
						<tr>
							<th>&oplus;</th>
							<td>
								Bitwise <a href="#ref48">Exclusive OR<sup>[48]</sup></a> (XOR) operator. E.g.<br>
								<code>0 &oplus; 0 = 0</code><br>
								<code>0 &oplus; 1 = 1</code><br>
								<code>1 &oplus; 0 = 1</code><br>
								<code>1 &oplus; 1 = 0</code>
							</td>
                        </tr>
						<tr>
							<th>+</th>
							<td>
								Regular addition. E.g.<br>
								<code>2 + 2 = 4</code>.
							</td>
                        </tr>
						<tr>
							<th>&otimes;</th>
							<td>
								Regular multiplication. E.g.<br>
								<code>5 &otimes; 5 = 25</code>.
							</td>
                        </tr>
						<tr>
							<th>%</th>
							<td>
								The <a href="#ref58">modulo<sup>[58]</sup></a> operation (mod). E.g.<br>
								<code>5 % 2 = 1</code><br>
								<code>9 % 3 = 0</code>.
							</td>
                        </tr>
						<tr>
							<th>||</th>
							<td>
								String <a href="#ref108">concatenation<sup>[108]</sup></a>. Inputs will be in the same 
								type and format before being concatenated together. E.g.<br>
								<code>72fa270d || 9148a82c = 72fa270d9148a82c</code>
							</td>
                        </tr>
						<tr>
							<th>&#8592;</th>
							<td>
								The variable <a href="#ref107">assignment<sup>[107]</sup></a> statement. E.g.<br>
								<code><i>c</i> &#8592; <i>a</i> + <i>b</i></code>
							</td>
                        </tr>
						<tr>
							<th>===</th>
							<td>
								The <a href="#ref111">strict equality<sup>[111]</sup></a> operator. E.g.<br>
								<code>if ($var === 37)<br>
									{<br>
									&nbsp;&nbsp;&nbsp; return true;<br>
									}
								</code>
							</td>
                        </tr>
                    </table>
                    
                    
					<h2 id="overall-network-architecture"><span>4</span> Overall network architecture</h2>
					<p>
						The following will outline the entire design of the application and how it works. Exact 
						implementation details can be found in the source code which is provided with every download.
					</p>					
					<p class="diagram">
						<a href="img/network-architecture.png">
							<img alt="Network architecture diagram" src="img/network-architecture.png" style="width: 100%">
						</a>
					</p>
					<ul>
						<li>
							The program uses a simple <a href="#ref49">star network<sup>[49]</sup></a> design. One particular 
							point about this client-server architecture is that the clients are the only devices which 
							have the one-time pads (encryption keys). The server effectively only contains encrypted 
							data. The clients operate on a request, response basis. For this reason the clients 
							which have the sensitive encryption keys should have their firewalls configured to block <b>all</b> 
							incoming traffic by default and only receive incoming data as responses to outgoing requests 
							that they have specifically made to the server. The responses from the server are always 
							authenticated using a shared API Key and any malformed or unauthentic responses are immediately 
							discarded. This makes the client machines a lot more resilient to attack and exfiltration of 
							encryption keys. Assuming the client machines are single purpose and are not used for 
							untrusted web browsing or other activities this is a very small attack surface. To use it 
							on a multi-purpose machine, the program could be run in a virtual machine e.g. 
							<a href="#ref50">CubesOS<sup>[50]</sup></a> to limit the attack surface.
						</li>
						<li>
							The server should have a firewall as well which only allows incoming application data on one 
							port and optionally on an SSH port for management. The server application expects a correctly 
							authenticated packet from the client or it discards the request and responds with a 
                            <code>HTTP/1.1 404 Not Found</code> error. Of course there is the potential for a 
                            <a href="#ref51">0-day vulnerability<sup>[51]</sup></a> 
                            in the server application layers but compromising the server will not 
							compromise confidentiality or authenticity of messages as they are encrypted end-to-end. If 
							an attacker gained access to the server they could only interfere with the server's operations 
							to block messages from being sent or received at all.
						</li>
					</ul>
					
					
					<h2 id="how-it-works"><span>5</span> How it works</h2>
					<ul>
						<li>
							The first user will run a True Random Number Generator. They can use their own or the one 
							included with the software. This random data is then broken up into separate one-time pads. 
							It is possible to generate enough data for a few thousand messages in under a minute. 
							A few thousand messages is enough for 6-12 months of communication at a reasonable frequency 
							of messages sent per day.
						</li>
						<li>
							Each user will be assigned specific one-time pads for sending messages. This prevents re-use 
							of a pad by another user. Re-using a pad 
							<a href="#ref52">can make cryptanalysis possible<sup>[52]</sup></a> so it is 
							very important to prevent this. The messaging protocol is explained in depth further on.
						</li>
						<li>
							Once the one-time pads are generated, the program can export them for each user to encrypted 
							text files. These should be saved directly onto removable flash media such as MicroSD card, 
							SD card, USB thumbdrive, CD, DVD, Blu-Ray Disc or portable hard drive. The program allows for 
							requires the one-time pad database to be encrypted and protected with a password.
							
							This adds additional protection so users do not need to securely erase the pads or physically 
							destroy the storage media after the one-time pads have been transferred unless they have very 
							high security requirements. If the users need plausible deniability that they are even 
							carrying one-time pads in the first place then there are some other precautions such as 
							creating a hidden <a href="#ref53">TrueCrypt<sup>[53]</sup></a> volume on the storage media 
							first before copying the pads into it.
						</li>
						<li>
							To get the one-time pads to the other users, ideally they will arrange a physical meetup. 
							This is to create a <a href="#ref54">secure channel<sup>[54]</sup></a> or 
							<a href="#ref55">air gap<sup>[55]</sup></a> to deliver the one-time pads which ensures the 
							encryption keys are not intercepted or compromised by transferring them over an insecure 
							network like the Internet. Key exchange is considered out of scope for the program itself as 
							this is the user's responsibility. The best method is to hide in plain sight. Here are a 
							few solutions that will usually work:
							<ul>
								<li>
									Meeting the users in person for a coffee/drink/lunch/dinner provides an innocent cover for 
									the exchange of encryption keys. If you are going about your daily activities this is the 
									least suspicious option and the most likely to succeed.
								</li>
								<li>
									A <a href="#ref56">dead drop<sup>[56]</sup></a>. Arrange the time and place 
									of the dead drop in person or using another method, but do not arrange this over an 
									insecure channel like the phone or Internet.
								</li>
								<li>
									If your country does not inspect internal mail you can hand sign a sealed / tamperproof 
									courier envelope and send it with reasonable assurance that it won't be compromised. 
									If the package appears to be opened on delivery, consider the encryption keys 
									compromised and do not use them. International mail is sometimes opened by 
									<a href="#ref57">Customs<sup>[57]</sup></a> so it is not a reliable method. It would 
									not be difficult to hide an encrypted MicroSD within something else though.
								</li>
								<li>
									It is not difficult to get a laptop, portable hard drive, MicroSD card, or SD card 
									through Customs at national or international airports. You can also hide them in 
									your carry-on luggage or on your person. If your government sometimes scans personal 
									phones or computers as people are going through Customs you may need to use 
									<a href="#ref59">steganography<sup>[59]</sup></a> to hide the 
									one-time pads within your vacation photos, videos or other files.
								</li>
								<li>
									Governments and diplomats also have the option of using a 
									<a href="#ref60">diplomatic bag<sup>[60]</sup></a> to transfer items to 
									another country which have diplomatic immunity from search or seizure under the 
									<a href="#ref61">Vienna Convention on Diplomatic Relations<sup>[61]</sup></a>.
								</li>
							</ul>
							The one-time pads absolutely cannot be sent via a less secure channel such as the Internet 
							even if using the best public key, block or stream cipher encryption there is. This reduces 
							the security to be only as strong as the cipher used and the 
							<a href="#ref62">perfect secrecy<sup>[62]</sup></a> that the one-time pad provides is lost.<br>
							<br>
							Some people complain about having to deliver the one-time pads physically as if this is some 
							impossible, arduous task. This line of thought is entirely devoid of reality. There is no 
							actual difficulty in storing some data on a portable memory stick and visiting someone in 
							person apart from a basic computer knowledge.
							
							If users are serious about taking their privacy back, they need to use encryption 
							which the NSA absolutely and unequivocally cannot break. If they are willing to trade 
							security for convenience and blindly use the NSA's recommended encryption 
							algorithms then they will only receive the amount of privacy that the NSA wants 
							them to have. The NSA does <u>not</u> have anyone's best interests at heart, they 
							want to monitor all communications and they will do that by whatever means necessary.
						</li>
						<li>					
							As the one-time pads are in transit it is important to keep them secured on one's person at 
							all times. They should not be left anywhere unattended and kept in a zipped up pocket to 
							prevent pickpockets. Ideally they could have a <a href="#ref63">tamper evident<sup>[63]</sup></a> 
							seal as well.
						</li>
						<li>
							Once the one-time pads are safely delivered and the server is set up, each user will load them into 
							the program and begin chatting. There are extra security considerations listed further on but 
							it will be important to erase the text file containing the one-time pads from the removable 
							media once they are loaded into the program. Storing the one-time pads and running the 
							software from within an encrypted container on the removable media will help mitigate most 
							issues. <a href="#ref78">VeraCrypt / TrueCrypt<sup>[78]</sup></a> and portable 
							<a href="#ref79">Firefox<sup>[79]</sup></a> can be used for this. 
						</li>
					</ul>
					
					
					<h2 id="configuring-own-server"><span>6</span> Server configuration</h2>
					<p>
						The server basically functions as a temporary database store for the encrypted messages. One user leaves encrypted 
						messages on the server and the other users can retrieve them when they are able. If both users are 
						connected at the same time it is possible for real-time chat, plus or minus a few seconds. The messages 
						are removed immediately from the server after they are read by all users.
					</p>
					<p>
						The server is user owned and operated which means users are in complete control of the communications. 
						No-one else knows about the server so this keeps it off the radar of the intelligence agencies, as 
						opposed to having a central server somewhere that everyone on the Internet is using. If everyone was 
						using a single server it leaves it as a single point of failure and the intelligence agencies can 
						<a href="#ref80">raid it<sup>[80]</sup></a>, 
						<a href="#ref81">hack it<sup>[81]</sup></a> or 
						<a href="#ref82">shut it down<sup>[82]</sup></a> 
						with a court order. There is no useful data for them on the server but they would be able to shut 
						down a lot of user's of communications at once, at least until someone set up a new server.
					</p>
					<p>
						The server code provides a <a href="#ref83">REST<sup>[83]</sup></a> based 
						<a href="#ref84">API<sup>[84]</sup></a> using 
						<a href="#ref85">JSON<sup>[85]</sup></a> which will run on the 
						<a href="#ref86">Apache<sup>[86]</sup></a> 
						2.2+ web server, <a href="#ref87">MySQL<sup>[87]</sup></a> 5.5+ database and 
						<a href="#ref88">PHP<sup>[88]</sup></a> 5.3+ programming language. PHP was chosen 
						because it is a <a href="#ref89">memory safe<sup>[89]</sup></a> language, 
						fast to develop in and fast to deploy along with a basic 
						<a href="#ref90">LAMP stack<sup>[90]</sup></a>. In a future 
						version, the design may be ported to another server side language, database and web server that 
						are considered more secure. The straightforward JSON REST API interface should enable the client 
						to connect with multiple different backend code bases and users can implement the one of their 
						choosing.
					</p>
					<p>
						At the moment, to get the server side running all that is needed is to install a basic 
						LAMP stack, copy the server files over to the web root directory, run the database script to 
						create the tables, then finally edit the config 
						file with the server's database and API login credentials. An 
						<a href="#ref92">easy to use guide<sup>[92]</sup></a> with screenshots for 
						<a href="#ref91">Ubuntu server<sup>[91]</sup></a> has been created for this. Users can install 
						a server their own network, or pay for a cheap 
						<a href="#ref93">VPS<sup>[93]</sup></a> somewhere. It is not recommended 
						to use a VPS in the US to rule out the possibility of the provider being issued with a 
						<a href="#ref94">National Security Letter (NSL)<sup>[94]</sup></a> 
						which would compromise security of the server.
					</p>
					
					
					<h2 id="server-authentication-protocol"><span>7</span> Server authentication protocol</h2>
					<p>
						A symmetric key based authentication protocol is used to securely authenticate the requests and 
						responses with the server API. This replaces TLS which secured the server API credentials 
						(username & password) in transit in versions up to 1.2. The reason for this was mainly to 
						simplify installation, 
						<a href="#ref46">avoid Certificate Authorities<sup>[46]</sup></a><a href="#ref47"><sup>[47]</sup></a><a href="#ref95"><sup>[95]</sup></a><a href="#ref96"><sup>[96]</sup></a>, 
						have resistance against active <a href="#ref97">MITM attacks<sup>[97]</sup></a> and 
						<a href="#ref36">quantum computers<sup>[36]</sup></a>. 
						There have also been major security problems with common TLS implementations such as 
						<a href="#ref98">OpenSSL<sup>[98]</sup></a>, 
						<a href="#ref99">GnuTLS<sup>[99]</sup></a> and 
						<a href="#ref100">iOS<sup>[100]</sup></a> which have led to a loss in confidence in these 
						programs which have poor code quality and may be hiding other NSA backdoors.
					</p>
					<h3 id="design-goals"><span>7.1</span> Design goals</h3>
					<ul>
						<li>
							Authenticate all API requests to the server to verify they are from valid server users.
						</li>
						<li>
							Authenticate all API responses from the server to verify the response came from the legitimate 
							server, not an attacker.
						</li>
						<li>
							Mitigate passive MITM attacks where an attacker tries to steal the API credentials in transit.
						</li>
						<li>
							Mitigate active MITM attacks where an attacker attempts to send fake responses to/from the server or 
							impersonate the server.
						</li>
						<li>
							Mitigate replay attacks and reject any request/response if the data was modified in transit.
						</li>
						<li>
							Prevent a request to the server being modified by an attacker to perform a different API action.
						</li>
						<li>
							Mitigate quantum computer attacks on the protocol.
						</li>
					</ul>
					
					<h3 id="limitations"><span>7.2</span> Limitations</h3>
					<ul>
						<li>
							The server administrator will control the server and be a user of the chat group's operating on that 
							server as well. The server administrator will be a trustworthy person not interested in interfering 
							with his own chat group's communications. If a group of users want to communicate with each other, 
							but the server administrator is not included in that group, then they should set up their own server.
							This rules out the server administrator having the will to interfere with communications.
						</li>
						<li>
							Users of the server have an interest in keeping the shared API key on the server a secret to protect 
							their own communications so they will not give that key to anyone else.
						</li>
						<li>
							There is no need for each user having a separate API key on the server to send/receive requests 
							because the server administrator could access that key anyway and impersonate them or simply edit 
							the database record to alter which user the message came from.
						</li>
						<li>
							There is trust between the users in the group communicating not to impersonate other users in the 
							chat group. Because every user in a group has access to all the same one-time pads and same API key, 
							it would technically be possible to pretend to be one of the other users in the chat group. This also 
							doubles as a <a href="#ref101">deniable authentication<sup>[101]</sup></a> 
							protocol because every message sent could have been engineered to come from one of the other 
							users in the chat group.
						</li>
						<li>
							Encryption for the server protocol is not required because individual messages are encrypted using the 
							one-time pads and signed on each client machine. Some anonymised, non-critical meta-data is viewable 
							if an attacker in a privileged network position is passively watching the traffic. This may indicate 
							a chat conversation is taking place using this protocol. If this is a problem, the user can easily 
							add TLS to the connection and use a pinned certificate. Version 2.0 of the program will encrypt the connection 
							between the client and the server using a cascade stream cipher to hide the meta data and to avoid 
							relying on TLS. Hiding the meta data by sending only encrypted binary blobs between the client 
							and server will make traffic analysis and fingerprinting much more difficult for spy tools like 
                            <a href="#ref102">XKeyScore<sup>[102]</sup></a>. 
                            Without knowledge of the protocol being used this means automated hacking tools that 
							<a href="#ref103">TAO agents<sup>[103]</sup></a> use will not know whether a client machine 
							is running this program or any other program sending binary data. This lowers the likelihood 
							of them being able to target the client machines with a specific exploit for this program to 
							extract the one-time pads or tamper with them.
						</li>
						<li>
							The server protocol does not anonymise IP addresses from users connecting to the server. If 
							there is a requirement for anonymity, then users can tunnel their connection through a SOCKS5 
							proxy in their web browser or tunnel their connection through the Tor network.
						</li>
					</ul>
					
					<h3 id="initial-setup"><span>7.3</span> Initial setup</h3>
					<ul class="formulas">
						<li>
							A random 512 bit <i>API Key</i> is created using the TRNG included with the program and entered 
							into the configuration file on the server. The user can use SSH to access their VPS, but ideally to 
							get the key securely onto the server, the server could be hosted on their local network running a web 
							server with a static public IP that is serving to the wider Internet. Storing the key in 
							the configuration file prevents SQL injection attacks to retrieve the key and also it saves a 
							database lookup each request.
						</li>
						<li>
							The <i>API Key</i> is given to each user in person (not using a key exchange protocol or sent 
							via an insecure network). This will be done in the initial key exchange between users as the program 
							can store the <i>API Key</i> and server address along with the one-time pads.
						</li>
						<li>
							The protocol currently caters for 2 - 7 users per group. If additional chat groups are required 
							on the same server this can also be setup. The cap of seven users per group is an arbitrary 
							restriction and can easily be extended. With larger group sizes however, each user gets less 
							one-time pads allocated to them for sending messages. In future the protocol could allow certain 
							users who talk more often a greater allocation of one-time pads for sending, e.g. one user 
							broadcasting announcements to the other users.
						</li>
					</ul>
					
					<h3 id="send-and-verify-api-request"><span>7.4</span> Client API request</h3>
					<ul class="formulas">
						<li>
							User creates a random 512 bit per request <a href="#ref106"><i>Nonce</i><sup>[106]</sup></a>. 
							The server keeps track of sent nonces to prevent replay attacks. The nonce is created using 
							the Web Crypto API <a href="#ref69">getRandomValues<sup>[69]</sup></a> method.
						</li>
						<li>
							User creates an API request including a group of data variables to send to the server as part of the 
							<i>Message Packet</i>. For example, this can contain the one-time pad encrypted message 
							and its MAC that the server will store.
						</li>
						<li>
							Each request is sent with an <i>API Action</i> to perform on the server. This prevents the attacker 
							from changing what action to perform on the server because any change to the data packet will alter 
							the MAC.
						</li>
						<li>
							The <i>From User</i> data indicates which user the message is from. The server uses this to retrieve 
							the correct key. All users on the server are coded to 
							<a href="#ref104">NATO phonetic alphabet<sup>[104]</sup></a> names i.e. 
							Alpha, Bravo, Charlie, Delta, Echo, Foxtrot and Golf. This allows some anonymity when multiple servers 
							around the world are using the same protocol. When exporting the one-time pads, the user can assign call 
							signs/nicknames to the chat users within the group to override the default names. These nicknames are 
							not transmitted to the server because they are kept in the user's local storage next to the one-time 
							pads.
						</li>
						<li>
							A <i>Sent Timestamp</i> is included to indicate when the request was sent. This is a 
							<a href="#ref105">UNIX timestamp<sup>[105]</sup></a> therefore both the client and 
							server code use UTC time.
						</li>						
						<li>
							The server rejects messages received that are received more than +/- 60 seconds of the 
							received UNIX timestamp. The server and clients should be synchronized to an NTP server. The 
							60 second allowance should be enough to counter any clock drift and subtle differences 
							between the server and client clocks.
						</li>
						<li>
							The server rejects duplicate messages/replay attacks received within the allowed time window 
							by storing all received nonces and checking incoming message timestamps against past received 
							nonces. If the nonce is the same and same request is received twice, then the second request 
							will be invalid. Sent nonces are kept on the server for at least 120 seconds and then 
							discarded by a separate cleanup process.
						</li>
						<li>
							These variables are stringified into JSON and a MAC is calculated using version 1.3 of the 
							<a href="#ref109">Skein<sup>[109]</sup></a> 512 bit (Skein-512) hash function on 
							the JSON data:<br>
							<br>
							<i>MAC</i> &#8592; <i>Skein-512</i>( <i>API Key</i> || <i>API Action</i> || <i>From User</i> || <i>Nonce</i> || <i>Sent Timestamp</i> || <i>Message Packet</i> )
						</li>
						<li>
							The client sends the JSON data and the MAC to the server. The server receives the request, looks up 
							the username and verifies it is a valid user for that chat group, then verifies the request by 
							recreating the same MAC with the data provided.
						</li>
						<li id="double-hmac-validation">
							The server rejects invalid MACs, which will also mean any attempt to modify the data sent 
							will fail. The MAC validation method in the API is protected against timing side channel 
							attacks using a method very similar to 
							<a href="#ref110">Double HMAC Verification<sup>[110]</sup></a>. This randomises the byte 
							order for each comparison so measuring timing differences for an attacker is practically 
							impossible. The differences in this program are that it uses the secure hash function 
							Skein-512 rather than HMAC-SHA-2 and some random data is introduced for each comparison as 
							an added security measure:<br>
							<br>
							<i>function constantCompare</i>( <i>Calculated MAC</i>, <i>Received MAC</i> )<br>
							{<br>
							<span class="functionInner"><i>Random Data</i> &#8592; Collect 512 bits from /dev/urandom</span><br>
							<span class="functionInner"><i>Hash A</i> &#8592; <i>Skein-512</i>( <i>API Key</i> || <i>Random Data</i> || <i>Calculated MAC</i> )</span><br>
							<span class="functionInner"><i>Hash B</i> &#8592; <i>Skein-512</i>( <i>API Key</i> || <i>Random Data</i> || <i>Received MAC</i> )</span><br>
							<br>
                            <span class="functionInner"><i>return</i> ( <i>Hash A</i> === <i>Hash B</i> )</span><br>
							}
						</li>
						<li>
							Failed requests can be re-sent manually by the client which will use a different <i>Nonce</i>, 
							<i>Sent Timestamp</i> and <i>MAC</i>.
						</li>
						<li>
                            The program also <a href="#ref112">Base64<sup>[110]</sup></a> encodes the entire packet 
							before sending in preparation for version 2.0. In version 2.0 the packet will also be 
							encrypted between the client and server and then Base64 encoded. The data going back and 
							forth will essentially just be a random binary blob. This will help disguise meta data and 
							make it much harder for spy agencies to fingerprint the traffic as definitely originating 
							from this program and prevent them targeting the client machines or server with automated 
                            <a href="#ref103">TAO hacking tools<sup>[103]</sup></a> or malware 
							that has been mentioned in the Snowden revelations. The current version will just 
							provide an extra annoyance to the Five Eyes agencies who will need to update their 
                            <a href="#ref102">XKeyScore<sup>[102]</sup></a> detection rules and decode the Base64 data 
							first in order to analyse it.
						</li>
					</ul>
					
					<h3 id="server-api-response"><span>7.5</span> Server API response</h3>
					<ul class="formulas">
						<li>
							On any valid server requests, the server signs the response with the <i>API Key</i> so that 
							the user knows the response from the real server. Invalid requests throw an 
							<code>HTTP/1.1 404 Not Found</code> error. This means an attacker does not even know if 
							there is a valid application or web page on the web server if they do not have the 
							<i>API Key</i> to make a valid request. All invalid requests respond with the server 
							pretending it is unable to find what the attacker is looking for. This is similar to 
							standard firewall behaviour by just failing to respond at all when an attacker is scanning 
							for open ports on your machine, rather than responding with a distinct 'closed' response 
							which indicates there is something there.
						</li>
						<li>
							The <i>Server Message Packet</i> contains data sent from the server including status responses 
							and the one-time pad encrypted messages.
						</li>
						<li>
							The original <i>Client Request MAC</i> is included in the server's response MAC calculation 
							so the client can be sure it is receiving a response to the original request.
						</li>
						<li>
							The <i>Server Message Packet</i> is stringified into JSON and a MAC is calculated using the
							Skein 512 bit hash function</a> on the JSON data:<br>
							<br>
							<i>MAC</i> &#8592; <i>Skein-512</i>( <i>API Key</i> || <i>Server Message Packet</i> || <i>Client Request MAC</i> )
						</li>
						<li>
							If the MAC does not match on the client then the response is not actually from the server and will be 
							discarded. A warning will be shown to the user that interference has occurred.
						</li>
						<li>
							On a successful request and response the client will process the data received from the server, 
							decrypt any received messages, check for XSS attacks and render the messages on the client. 
						</li>
					</ul>
					
					
					<h2 id="frustrating-traffic-analysis"><span>8</span> Preventing information leakage and traffic analysis</h2>
					<p>
						The program ends decoy messages at random intervals to other users in 
						the chat group to prevent 
						<a href="#ref113">information leakage<sup>[113]</sup></a> about when 
						real messages are sent and to frustrate 
						<a href="#ref65">traffic analysis<sup>[65]</sup></a>. The technique 
						used is similar in principle to the 
						<a href="#ref114">Chaffing and Winnowing<sup>[114]</sup></a> 
						cryptographic technique. On starting a 
						chat session, each client will generate a random number between 1000 and 90,000 using the 
                        <a href="#ref69">browser's CSPRNG<sup>[69]</sup></a>. 
                        A timer will be started and after this number of milliseconds have 
						elapsed the program will generate a random string of bytes up to 56 bits bits in length. Using 
						the accuracy of milliseconds rather than seconds gives more randomness for each timer interval. 
						Otherwise every decoy message would be sent on evenly rounded seconds and an attacker could 
						determine that they were decoy messages.
					</p>
					<p>						
						The program will then check if these 56 bits exist as a pad identifier in their own set of 
						one-time pads. If that pad identifier already exists, which is quite rare, then it will skip 
						sending a decoy message for this interval, generate a new random 
						number and try again after that many seconds have elapsed. If the pad identifier does not already 
						exist, then the program will send a decoy message to the other users in the chat group. The other 
						chat group users will safely ignore the decoy message as the pad identifier does not exist in 
						their copy of the one-time pad database for the user that is sending the message. To send a 
						decoy message the program simply generates a further random 1480 bits using the 
                        <a href="#ref69">browser's CSPRNG<sup>[69]</sup></a> 
						and concatenates that to the end of the 56 bit random pad identifier, thus forming a random 
						string consisting of 1536 bits which is the same size as a regular one-time pad and message packet. 
						This method also avoids burning real one-time pads on decoy messages which would be wasteful.
					</p>
					<p>
						The random message packet is sent to the server and left on there for the other chat group 
						users to collect. It effectively looks no different than a regular message being sent. The other 
						chat group users will download it, determine it is not a real message because the pad identifier 
						does not exist in the set of pads belonging to that user and discard it. The other users may not 
						be saying anything but each client that is connected to the server will be sending decoy messages 
						to other users in the group at random intervals. If two or more clients are left unnattended 
						it can look like an entire conversation is taking place without doing anything. This disguises 
						when real messages are actually sent by the users. An outside attacker that can monitor all 
						network traffic has no way of determining whether a message sent or received is a decoy or a real 
						one. 
					</p>
					<p>
						If a client is online but there have been no real or decoy messages received from other chat 
						clients for 5 minutes then the decoy timer will stop. This is so it doesn't appear like one user 
						is just	talking to themself. If another client comes online again and sends a real message or 
						decoy message then the first client will start up their timer again on a random interval to keep 
						sending decoy messages. This continues until a user quits the program or all other users are 
						offline for over 5 minutes. This is more than the maximum random timer interval 
						(90 seconds) so there is some overlap when users are coming online/offline. These intervals 
						may be customisable via the UI in future versions or further optimised for network bandwidth 
						usage.
					</p>
					<p>
						An added bonus of this functionality is that if a user has come online and received a new decoy 
						message from another user they can know that the other user is most likely online (+/- 90 seconds) 
						without any other kind of signalling protocol being needed. The program will also show that the 
						other user is online immediately if a real message is received within the last 5 minutes as well.
					</p>
					
					
					<h2 id="using-tls"><span>9</span> Using Transport Layer Security (TLS) / HTTPS</h2>
					<p>
						Because of the new server authentication protocol in version 1.3, using TLS is not mandatory anymore. 
						However it can be added as an optional layer of security to help mitigate monitoring from 
						lower level attackers, for example when using the program in a workplace, public WiFi hotspot or 
						home connection where an employer, casual hacker or ISP could monitor the connection. 
						<a href="#ref45">TLS will not stop a nation state attacker<sup>[45]</sup></a> 
						like the NSA as it is possible they have obtained copies of the root keys for most 
						Certificate Authorities anyway by using 
						<a href="#ref94">National Security Letters<sup>[94]</sup></a>, therefore 
						they can perform an active <a href="#ref44">MITM<sup>[44]</sup></a> 
						attack as traffic is passing through the <a href="#ref5">Five Eyes<sup>[5]</sup></a>  
						alliance countries (USA, UK, Canada, Australia and NZ). It is also possible 
						<a href="#ref36">they have quantum computers<sup>[36]</sup></a> 
						by now. The public key exchange protocols used in TLS are vulnerable to quantum computers, as 
						are most of the common cipher suites which use symmetric keys of only 128 bits. Key lengths of 
						<a href="#ref116">256 bits are the minimum required<sup>[116]</sup></a> to 
						remain safe against quantum computers in the immediate future. Care must also be taken to use a 
						good cipher suite order to have forward secrecy and use the highest quality ciphers available.
					</p>
					<p>						
						Users still wanting to use TLS and don't mind the extra effort to configure it are recommended to 
						generate a strong (4096+ bit RSA) self-signed certificate themselves using 
						<a href="#ref117">the guide on the site<sup>[117]</sup></a>, install it on the server and deliver 
						the fingerprints of the certificate to the chat group users at the same time as the one-time pad 
						key exchange which they can manually verify when first connecting to the server.
					</p>
					
					
					<h2 id="trng-custom"><span>10</span> User Chosen TRNG</h2>
					<p>
						The software allows a user to import truly random data directly from their own trusted entropy 
						source. This could be a <a href="#ref22">hardware RNG<sup>[22]</sup></a>, physical entropy source 
						or even capturing the output from Linux/Unix's <a href="#ref70">/dev/random<sup>[70]</sup></a>. 
						This gives the user some flexibility and can allow for creating a lot more one-time pads than 
						can be created using the TRNG included with the program.
						
						Because the user can freely choose to use their own entropy source for creating the one-time pads, 
						this rules out any possibility that the author of the program is interested in restricting the user 
						to use a poor quality random number generator which would expose the user to covert surveillance.
					</p>
					<p>
						Users can change the file type of the file they are importing from pure binary, to a plain text 
						file containing <a href="#ref186">hexadecimal<sup>[186]</sup></a> symbols or Base64 characters. 
						Once uploaded, randomness tests found in <a href="#ref124">FIPS 140-2<sup>[124]</sup></a> will 
						be run on the random data to ensure that the imported random data is up to a minimum acceptable 
						level.
						If the tests pass, the user can export the random data and the 
						program will split up the random data into separate one-time pads for use with the program. Users 
						do not have to rely on the FIPS 140-2 tests alone, they can of course run any number of external 
						randomness tests on their data to ensure it is of good quality before importing it.
					</p>
					
					
					<h2 id="trng-photo"><span>11</span> Included Photo Based TRNG</h2>
					<p>
						Nature is random, unpredictable and always changing. For example, the sand on the 
						seashore changes every time the tide rolls in. Wave crests and currents change with the weather and tides. 
						Deciduous trees change depending on the season of the year. Trees and leaves move in the wind. The sun 
						strikes things in different angles and intensity throughout the day, casting shadows in various directions. 
						The variance of cloud cover and light conditions alters the appearance of everything in different ways.
					</p>
					<p>
						This section describes the True Random Number Generator (TRNG) included with the program which gathers 
						the entropy contained in the <a href="#ref71">shot noise<sup>[71]</sup></a> of a high 
						resolution photograph from a digital camera to obtain truly random data, then it runs a randomness extractor 
						on the data to ensure a uniform distribution. The shot noise contains random data because the act of capturing 
						something, converting it from analog to digital, and storing it in 24 bit values creates randomness due 
						to the fact that the process creates noise on the 
						<a href="#ref72">least significant bits<sup>[72]</sup></a>. 
						Randomness tests are run on the random data after the randomness extractor has run to 
						verify the quality.
					</p>
					<p>
						From a photographer's position they have a unique viewpoint of a scene in nature. They can take 
						a photo of anything in nature, giving an infinite number of possible photographs. The proposed 
						method is to take a photograph of something that is random in nature such as a 
						<a href="#ref73">macro<sup>[73]</sup></a> (extreme close-up) shot of 
						sand on a beach, grass, rocks, flowers. Or a regular photo of bushes, trees blowing in the wind, 
						wave crests in the ocean, or waves crashing against the sea shore. The photo should be taken 
						with high resolution and in focus using a standalone digital camera. 
					</p>
					
										
					<h3 id="quality-photo-selection"><span>11.1</span> Selecting a quality photograph</h3>
					<p>
						The best results are obtained capturing the photograph using a digital camera's 
						<a href="#ref74">RAW mode<sup>[74]</sup></a> then converting the RAW image file  
						as-shot (without post-processing) to a lossless format like 
						<a href="#ref75">PNG<sup>[75]</sup></a> or 
						<a href="#ref76">BMP<sup>[76]</sup></a> 
						for the TRNG program to process. 
						Saving in a lossy algorithm like <a href="#ref77">JPEG<sup>[77]</sup></a> may have unintended 
						side effects from performing optimisations on the photograph. Modern digital cameras in cellular phones may not 
						be suitable as they usually compress the photo using JPEG. Users can however verify the processed results 
						and check if the random data passes the required randomness tests.
					</p>
					<p>
						Photographs should be taken of things in nature e.g. sand, rocks, flowers, bushes and trees. 
						For smaller items like sand, macro mode should be used. All photographs should be in focus.
					</p>
					<p>
						Photographs should always be erased after one-time pads have been created from them and not left 
						on any storage device.
					</p>
					

					<h3 id="photo-processing-algorithm"><span>11.2</span> TRNG photo processing algorithm</h3>
					<p>
						The algorithm is a randomness extractor which extracts random data from a photograph. 
						This full algorithm is explained below:
					</p>
					<ol>
						<li>
							Load the user's photograph into memory as a sequential array of pixels. The top left pixel 
							would be the first element in the array, followed by the rest of the pixels in that row 
							(left to right), followed by the pixels in the rows below and so on.
							Each pixel in the photograph contains 24 bits of colour information, encoded as 
							separate red, green and blue (RGB) integer values. Each colour channel has 8 bits of 
							information, represented as a number from 0 to 255. The data should be loaded in a 
							format similar to:<br>
							[ [<b>120, 234, 123</b>], [<b>57, 23, 254</b>], [<b>14, 255, 0</b>], ... ].<br>
							or more simply:<br>
							[ <b>120, 234, 123, 57, 23, 254, 14, 255, 0, ... </b>].<br>
						</li>
						<li>
							Loop through all the pixels in the image i.e. groups of 3 RGB integer values at a time. 
							Compare each current pixel to the previous one.
							Remove sequentially repeating black pixels [<b>0, 0, 0</b>], sequentially repeating white 
							pixels [<b>255, 255, 255</b>] and pixels that are exactly the same colour as the previous one 
							e.g. [ [<b>120, 234, 123</b>], [<b>120, 234, 123</b>] ]. This removes sections of the 
							photograph with underexposed pixels, overexposed pixels and those that have have very little 
							entropy. Generally it is very rare to have adjacent pixels that are exactly the same colour 
							unless there is a hardware failure, or that section of the photo is under/overexposed. 
							Usually in a good quality photograph there are at least very slight variations in the colour 
							channels for adjacent pixels. This step removes these low entropy areas.
						</li>
						<li>
							By default, the program estimates that there is 1 bit of input entropy per 24 bit pixel. 
							This is a very conservative estimate. Users can safely increase this estimate in the 
							settings to 3 bits per 24 bit pixel which would account for the entropy in the 
							<a href="#ref72">least significant bit<sup>[72]</sup></a> 
							of each colour channel. Collect an estimated 512 bits of entropy from the array of pixels. 
							For an estimate of 1 bit per pixel, this would be 512 RGB pixels (1536 integer values). 
							If users have increased the estimate setting to 3 bits per pixel, collect 171 RGB pixels 
							(513 integer values) for the same estimated input entropy of 512 bits. It is critical for 
							the program to remember a current index value in the pixel array, which is used to mark  
							the point at which pixels have already been collected. For example, if 512 pixels were 
							collected, the index would currently be at 511 (in a 0 based array). The next collection of 
							entropy would start from array index 512. This is so previous pixels are not re-used.
						</li>
						<li>
							Convert the pixels from their RGB integer values to their hexadecimal representation. For 
							example, [ [<b>120, 234, 123</b>], [<b>57, 23, 254</b>] ] becomes 
							[ [<b>78ea7b</b>], [<b>3917fe</b>] ].
						</li>
						<li>
							Concatenate the hexadecimal data together, for example, <b>78ea7b3917fe</b>. Input the data 
							into a cryptographic hash function with a 512 bit output 
							digest. The program defaults to the <a href="#ref109">Skein-512<sup>[109]</sup></a> 
							hash function. The user can also choose to use 
							<a href="#ref118">Keccak-512<sup>[118]</sup></a><a href="#ref119"><sup>[119]</sup></a>  
							with the capacity set at 1024 bits. Both these hash functions are very strong finalists from 
							the <a href="#ref120">NIST hash function competition<sup>[120]</sup></a>. 
							Store this hash output of 512 bits as the initial temporary seed.
						</li>						
						<li>Start a program <a href="#ref121">while loop<sup>[121]</sup></a>:
							<ol class="roman">								
								<li>
									Check there is enough new input entropy in the pixel array for the new hash, or 
									break out of the loop.
								</li>
								<li>
									Get the temporary seed from earlier.
								</li>
								<li>
									Collect 512 bits of fresh entropy from the pixel array and convert it to hexadecimal 
									format. For an estimate of 1 bit per pixel, this would be 512 RGB pixels (1536 
									integer values). The program should use the current index value so it does not 
									collect already used entropy.
								</li>
								<li>
									Concatenate the temporary seed and input entropy together. Then hash them using: 
									<span class="formulas"><i>Hash</i>( <i>temporary seed</i> || <i>input entropy</i> )</span>.
								</li>
								<li>
									Append the first 256 bits of the hash function's output digest to the output random 
									data.
								</li>								
								<li>
									Update the temporary seed to be the last 256 bits of the hash function's output 
									digest.
								</li>
								<li>
									Update the current index position which marks which pixels have been used in the 
									array. This is so that next time new entropy is collected it does not collect 
									previously used pixels.
								</li>
								<li>
									Return to start of the loop.
								</li>
							</ol>
						</li>
						<li>
							Erase the original photograph from the camera's memory card and the computer's hard disk. 
							If full disk encryption is used, only a regular deletion is needed.
						</li>
						<li>
							Use the output random data and split it into separate one-time pads of 1536 bits each.
						</li>
					</ol>
					<p>
						Using an initial temporary seed of 512 bits and combining this with 512 bits of fresh input 
						entropy in the hash function makes the first output digest very strong. Only the first 256 bits 
						of this is used as the random data for the one-time pads. The remaining 256 bits is used as a 
						temporary seed for the next hash. The purpose of the temporary seed in each loop is so that if 
						there is a section of low entropy in the photograph (blue sky, white clouds etc), then the 
						output random data still has at least 256 bits of good entropy from the temporary seed.
					</p>
					<p>
						It is important to note that this algorithm does not use this collected entropy to seed a   
						<a href="#ref122">psuedo-random number generator<sup>[122]</sup></a> 
						to give an unlimited amount of random data. The program aims to be a true random number generator so 
						only quality randomness is wanted and each uniformly random bit must be used solely to encrypt one 
						bit of the plaintext. It's assumed that most psuedo-random number generators or even 
						<a href="#ref123">CSPRNGs<sup>[123]</sup></a> that stretch out the entropy could produce 
						a subtle bias in the output and allow the NSA or other governments to decrypt part or all of a 
						message. With this program the aim is to avoid stretching the available entropy over more bits.
					</p>
										
					
					<h3 id="output-testing"><span>11.3</span> Testing the TRNG random output</h3>
					<p>
						An important part of a random number generator is the ability to test the output. A few methods have been 
						provided for this:
					</p>
					<ul>
						<li>
							Extracting the random data in various formats (binary file, hexadecimal & Base64) gives users 
							the opportunity to verify the data with another randomness testing program. That will allow them to 
							run additional tests and assure them of the quality of the random data.
						</li>
						<li>
							For testing the random data there are some statistical random number generator tests included from 
							<a href="#ref124">FIPS 140-2<sup>[124]</sup></a>. These 
							include: The Monobit Test, The Poker Test, The Runs Test and The Long Run Test. The goal is to add 
							more automated tests in the future to prove the quality of the program and improve on it in future 
							versions of the software. The FIPS 140-2 test suite is run on every 20,000 bits in the extracted 
							random data. If any of the tests fail after this, then the original source photograph was 
							definitely not good enough and another one will need to be used.
						</li>
						<li>
							The output of the TRNG can also be viewed as a <a href="#ref125">bitmap<sup>[125]</sup></a> 
							image which lets a user do a simple visual analysis of the output. 
							<a href="#ref126">Random.org explains<sup>[126]</sup></a> that people are really good at 
							spotting patterns and visualising the random data allows them to use their eyes and brain 
							for this purpose. It also gives a rough impression of the TRNG's performance.<br>
							<br>
							To produce this, all the random data is converted to binary and rendered as a bitmap. A 
							black pixel indicates a '1' bit and white pixel indicates a '0' bit. The output should look 
							something like the image below at 100% zoom.
						</li>
					</ul>
					<p class="diagram">
						<img src="img/random-bitmap-example.png" alt="Random bitmap example">
					</p>
					
										
					<h3 id="trng-test-analysis"><span>11.4</span> TRNG tests and analysis</h2>
					<p>
						For testing a 12 MP 
						<a href="#ref127">Canon PowerShot G9<sup>[127]</sup></a> 
						digital camera was used. This camera is a high-end compact digital camera and allows taking 
						photographs in <a href="#ref128">RAW file format<sup>[128]</sup></a>. 
						Photos were taken in manual mode using the RAW file format. The photos were then loaded into 
						Photoshop, converted as is to PNG which avoided using the camera's default lossy JPEG file 
						format. Then tests were run by taking photographs of various places and things, processing the 
						photos with the TRNG and running the test suite on everything. The results are presented below.
					</p>
					<p>
						<i>
							The original camera images were 4000 x 3000 pixels, then have been cropped to 1000 x 750 pixels 
							for faster processing and to save bandwidth. The photos were processed with the Skein 512 bit hash 
							algorithm and an estimate of 1 bit per pixel entropy input.<br>
							<br>
							<span class="nonPrintable">Click on the thumbnail images below to see a bigger image.</span>
						</i>
					</p>
					
					
					<h3>Macro shot of sand at a beach</h3>
					<p>
						This is an example of the TRNG output from processing a macro shot of sand at a beach. 
						<span class="nonPrintable">
							See the full test results output <a href="img/randomness-tests/sand-test-results.txt">here</a> as a text file.
						</span> 
						This passes all the randomness tests and is one of the best photograph sources.
					</p>
					<div class="testOutput">
						<h4>Original photo</h4>
						<a href="img/randomness-tests/sand-original-photo.png">
							<img class="nonPrintable" src="img/randomness-tests/sand-original-photo-preview.png" alt="Sand">
							<img class="printable" src="img/randomness-tests/sand-original-photo.png" alt="Sand">
						</a>						
					</div>					
					<div class="testOutput">
						<h4>Extracted entropy</h4>
						<a href="img/randomness-tests/sand-extracted-entropy.png">
							<img class="nonPrintable" src="img/randomness-tests/sand-extracted-entropy-preview.png" alt="Sand">
							<img class="printable" src="img/randomness-tests/sand-extracted-entropy.png" alt="Sand">
						</a>
						<div class="results">Extracted entropy FIPS 140-2 tests: <span class="pass">Pass</span></div>
					</div>
					
					
					<h3>Macro shot of grass</h3>
					<p>
						This is an example of the TRNG output from processing a macro shot of grass in a field. 
						<span class="nonPrintable">
							See the full test results output <a href="img/randomness-tests/grass-test-results.txt">here</a> as a text file.
						</span> 
						This passes all the randomness tests and is one of the best photograph sources.
					</p>
					<div class="testOutput">
						<h4>Original photo</h4>
						<a href="img/randomness-tests/grass-original-photo.png">
							<img class="nonPrintable" src="img/randomness-tests/grass-original-photo-preview.png" alt="Grass">
							<img class="printable" src="img/randomness-tests/grass-original-photo.png" alt="Grass">
						</a>						
					</div>
					<div class="testOutput">
						<h4>Extracted entropy</h4>
						<a href="img/randomness-tests/grass-extracted-entropy.png">
							<img class="nonPrintable" src="img/randomness-tests/grass-extracted-entropy-preview.png" alt="Grass">
							<img class="printable" src="img/randomness-tests/grass-extracted-entropy.png" alt="Grass">
						</a>
						<div class="results">Extracted entropy FIPS 140-2 tests: <span class="pass">Pass</span></div>
					</div>
					
					
					<h3>Photo of trees</h3>
					<p>
						This is an example of the TRNG output from processing a photo of trees. 
						<span class="nonPrintable">
							See the full test results output <a href="img/randomness-tests/trees-test-results.txt">here</a> as a text file.
						</span> 
						This is not a particularly good photograph due to it being overexposed with some of the bright cloud 
						showing through the trees, thus the overexposed sections will be a single repeated colour. The 
						algorithm will remove these overexposed sections and the extracted output still passes the tests, 
						however there is less usable random data than normal.
					</p>
					<div class="testOutput">
						<h4>Original photo</h4>
						<a href="img/randomness-tests/trees-original-photo.png">
							<img class="nonPrintable" src="img/randomness-tests/trees-original-photo-preview.png" alt="Trees">
							<img class="printable" src="img/randomness-tests/trees-original-photo.png" alt="Trees">
						</a>						
					</div>
					<div class="testOutput">
						<h4>Extracted entropy</h4>
						<a href="img/randomness-tests/trees-extracted-entropy.png">
							<img class="nonPrintable" src="img/randomness-tests/trees-extracted-entropy-preview.png" alt="Trees">
							<img class="printable" src="img/randomness-tests/trees-extracted-entropy.png" alt="Trees">
						</a>
						<div class="results">Extracted entropy FIPS 140-2 tests: <span class="pass">Pass</span></div>
					</div>
					
					
					<h3>Photo of water</h3>
					<p>
						This is an example of the TRNG output from processing a photo of water in a harbour. 
						<span class="nonPrintable">
							See the full test results output <a href="img/randomness-tests/water-test-results.txt">here</a> as a text file.
						</span>
					</p>
					<div class="testOutput">
						<h4>Original photo</h4>
						<a href="img/randomness-tests/water-original-photo.png">
							<img class="nonPrintable" src="img/randomness-tests/water-original-photo-preview.png" alt="water">
							<img class="printable" src="img/randomness-tests/water-original-photo.png" alt="water">
						</a>						
					</div>					
					<div class="testOutput">
						<h4>Extracted entropy</h4>
						<a href="img/randomness-tests/water-extracted-entropy.png">
							<img class="nonPrintable" src="img/randomness-tests/water-extracted-entropy-preview.png" alt="water">
							<img class="printable" src="img/randomness-tests/water-extracted-entropy.png" alt="water">
						</a>
						<div class="results">Extracted entropy FIPS 140-2 tests: <span class="pass">Pass</span></div>
					</div>
					
					
					<h3>Photo of clouds</h3>
					<p>
						This is an example of the TRNG output from processing a photo of clouds. 
						<span class="nonPrintable">
							See the full test results output <a href="img/randomness-tests/clouds-test-results.txt">here</a> as a text file.
						</span> 
						Clouds are generally not a good source photograph as there are a lot of repeating colours. These 
						do get stripped out with the algorithm, but in the end you are left with less random data. The 
						extracted output will still pass the FIPS 140-2 tests, however it may be wiser to use another 
						source image.
					</p>
					<div class="testOutput">
						<h4>Original photo</h4>
						<a href="img/randomness-tests/clouds-original-photo.png">
							<img class="nonPrintable" src="img/randomness-tests/clouds-original-photo-preview.png" alt="clouds">
							<img class="printable" src="img/randomness-tests/clouds-original-photo.png" alt="clouds">
						</a>						
					</div>
					<div class="testOutput">
						<h4>Extracted entropy</h4>
						<a href="img/randomness-tests/clouds-extracted-entropy.png">
							<img class="nonPrintable" src="img/randomness-tests/clouds-extracted-entropy-preview.png" alt="clouds">
							<img class="printable" src="img/randomness-tests/clouds-extracted-entropy.png" alt="clouds">
						</a>
						<div class="results">Extracted entropy FIPS 140-2 tests: <span class="pass">Pass</span></div>
					</div>
					
					
					<h3>Summary</h3>
					<p>
						In summary, the best results are achieved using the macro mode on a digital camera and taking close-up 
						shots of things like sand or grass. Shooting a variety of things like rocks, trees or water can also 
						work. Users can experiment taking photos of various things in nature on their own. Users should take 
						care to verify the extracted random data passes the tests from FIPS 140-2. This will give 
						reasonable confidence for using it as one-time pads. With this TRNG and a single 12 MP photo, it 
						can produce enough random data for approximately 3900 messages (depending on the source photograph 
						quality).
					</p>
					<p>
						The safest method is to use a photo from a standalone digital camera that has been captured in 
						the camera's raw image format, transferred to a computer by USB cable (or SD card), 
						then losslessly converted to PNG (or BMP) file format. Users should avoid using a mobile phone as 
						they generally have poor security and the contents can be secretly collected from them at any 
						time due to the <a href="#ref129">closed baseband processor<sup>[129]</sup></a>. 
						The user should always erase the original photo after the one-time pads have been created from 
						it. To be completely secure, users should run the TRNG program from a non-networked 
						(<a href="#ref130">air gapped<sup>[130]</sup></a>) computer.
					</p>
										
															
					<h2 id="pad-storage-export"><span>12</span> Pad storage and exporting data</h2>
					<p>
						After the one-time pads have been created, they must be exported separately for each user. Part of this 
						process automatically determines who will be sending with what one-time pads. The one-time pads are divided 
						up equally amongst the group members and allocated to each user for sending. This prevents one user from 
						accidentally sending with another user's allocated one-time pads, causing a two-time pad situation and 
						allowing for cryptanalysis. All users get read access to the other group member's one-time pads, so when 
						a message is received from another user they can decrypt it.
					</p>
					<p class="diagram">
						<img alt="Export settings" src="img/export-pads-settings.png">
					</p>
					<ul>
						<li>
							This screen contains all the details that will be saved to each export file for each chat group user. 
							The person creating the chat group should input the server address and API key here so that when other 
							users import the file they do not need to do any additional configuration. All they need to do 
							then is load the one-time pads into their browser and start chatting. 
						</li>
						<li>
							A server API key can be generated from this screen. The program effectively takes 512 bits from the 
							start of the extracted random data and uses it as the key. This 512 bits is now no longer available 
							for use as a one-time pad. This API key is manually loaded up into the server's config file by the user. 
							After this the user can test the connection to the server to make sure everything is set up correctly.
						</li>
						<li>
							The user can also define how many users will be in the chat group. They can customise the user's name 
							or nickname next to the call sign. The custom nickname is kept locally and stored with the one-time pads. 
							This way each chat group user has the same set of names and knows who is in the conversation. The custom 
							nickname is not sent over the network, only the call sign (alpha, bravo etc) is sent as part of each 
							network request so the server can send/receive messages for that user. This means only the real users 
							know who is talking to who. If there are multiple people and chat groups around the world using the 
							same protocol and different servers, then it makes traffic analysis even more difficult.
						</li>
						<li>
							There are 3 export options for using the one-time pads with the program. <b>Export to clipboard</b> 
							lets you copy/paste the pads from memory into wherever you want to put them. <b>Export to text file</b> 
							pops up a save dialog to save the pads to a text file on your filesystem or portable storage media. 
							Exporting to the <b>browser's local database</b> is if you want to export the created pads for that 
							user into the local storage of that device/computer browser directly and start chatting immediately.
						</li>
						<li>
							Saving to removable media such as a CD, DVD, MicroSD, SD card or USB drive will be convenient and 
							portable. Flash memory is at least small and compact which means you can conceal, destroy or 
							get rid of it quickly and easily. The most secure option may be to use CDs/DVDs which can be 
							written once, transferred to each user, then destroyed. The most convenient option is to get 
							a USB thumbdrive, with a portable version of 
							<a href="#ref79">Firefox<sup>[79]</sup></a> loaded on it. 
							Save the one-time pads in there as well. Load up Firefox and then load the one-time pads from 
							inside it. Now the program is portable and you can take it with you on your keyring, run it 
							from any trusted computer (e.g. home or work) and stay in contact wherever you are.
						</li>
						<li>
							Hard drives and flash memory <a href="#ref131">are difficult<sup>[131]</sup></a> to remove 
							data from quickly and securely. It is best if sensitive data like encryption keys do not get 
							written to the disk in the first place. The program allows for the one-time pad database to be 
							encrypted and authenticated before transport. This is detailed in full in the next section.
						</li>
						<li class="formulas">
							The password/passphrase used should have at least 256 bits of entropy for transport which is 
							estimated to be 41 ASCII characters. In version 2.0 the database will be encrypted all the 
							time so users may opt for a shorter password for faster access on their mobile devices.
							The password strength estimator calculates a rough estimate of the password strength in bits 
							as the user is typing. Password characters are assumed to be drawn uniformly randomly among the 
							most commonly used characters on a standard US keyboard. This is calculated as uppercase A-Z 
							(26 characters) plus lowercase a-z (26 characters) plus numbers 0-9 (10 characters) for a 
							total of 62 characters. This will produce a more conservative entropy estimate than if special 
							characters were included as well (i.e. the full 95 ASCII printable characters). The formula 
							will also take into account the 
							<a href="#ref28">Password Based Key Derivation Function (PBKDF)<sup>[28]</sup></a> iterations 
							which roughly increases the security in bits by <i>log<sub>2</sub></i>( <i>Iterations</i> ) 
							e.g. <i>log<sub>2</sub></i>( <i>10,000</i> ) which is approximately 13~ bits. The full 
							formula for calculating the entropy of the password in bits is as follows:<br>
							<br>
							<b>Entropy Bits</b> &#8592; ( <i>Number of Password Characters</i> &otimes; <i>log<sub>2</sub></i>( <i>62</i> )) + <i>log<sub>2</sub></i>( <i>Number of PBKDF Iterations</i> ).							
						</li>
					</ul>
					
					
					<h2 id="database-encryption"><span>13</span> One-time pad database encryption and authentication</h2>
					<p>
						The program can encrypt and authenticate the one-time pad database prior to export and 
						transportation to other chat group users. The program uses a cascade of two strong stream ciphers 
						for encryption and a cascade of two modern MAC algorithms for authentication. This provides 
						additional assurances such as:
					</p>
					<ul>
						<li>
							The database has not been tampered with in transit. An attacker cannot replace the 
							one-time pads with ones that they already know which would allow covert surveillance, set 
							all the one-time pads to zero bits which would nullify the encryption, subtly duplicate the 
							one-time pads in the database which would allow for two-time pad cryptanalysis, or swap pads 
							between users which would cause indecipherable messages for other users in the group.
						</li>
						<li>
							The database is not easily readable if stolen or seized in transit. A computationally unbounded 
							adversary could in theory break the cascade encryption after many decades of brute force 
							attack with a quantum computer, but this is very unlikely. If a user knew that their 
							one-time pad database was stolen or seized (e.g. at an international airport) then they 
							would notify the other chat group users to stop using that set of one-time pads immediately 
							and switch to a different set. Then only the small number of messages which had been sent 
							since one-time pad generation until that point in time would be compromised. Because only a 
							small number of messages would have been sent during this time and the database is very 
							difficult to crack, then this reduces the likelihood an attacker would even try mounting a 
							brute force attack.
						</li>
						<li>
							After successful transportation of the one-time pads without interception or tampering, the 
							database can be quickly deleted and the rewritable transport media (e.g. MicroSD card, SD 
							card, USB drive) can be re-purposed for something else which would overwrite the database 
							eventually anyway. Because an attacker does not even have the encrypted one-time pad 
							database, it is not absolutely necessary to secure erase the media or destroy it (e.g. 
							write once CD, DVD media) unless absolute security is required.
						</li>
					</ul>
					<p>
						In version 2.0 of the program, which is currently in development, the same encryption will be 
						used to secure the database as it resides on the client devices. Pads will be decrypted as they 
						are needed, used to encrypt a message, then deleted from the database. The program does not currently  
						provide any steganography for transporting the database, so if this is needed in the near future 
                        it is advised to use a 
						<a href="#ref132">TrueCrypt 7.1a hidden volume<sup>[132]</sup></a><a href="#ref133"><sup>[133]</sup></a> 
                        and store the one-time pad database inside it. If an attacker forces you to reveal the password 
						you can reveal the outer volume password which would reveal decoy files, and you would still 
						have plausible deniability that a hidden volume containing the one-time pads does not exist.
					</p>
					
					<h3 id="cascade-database-encryption"><span>13.1</span> Cascade database encryption</h3>
					<p>
						To encrypt each one-time pad in the database a cascade of two strong, reputable stream 
                        ciphers is used. The ciphers are the 
                        <a href="#ref134">Advanced Encryption Standard (AES)<sup>[134]</sup></a> 
                        in <a href="#ref135">Counter Mode<sup>[135]</sup></a> (AES-CTR) 
                        and <a href="#ref136">Salsa20<sup>[136]</sup></a> with the full 20 rounds. AES, 
                        which is based on the Rijndael algorithm by Vincent Rijmen and Joan Daemen, won the 
                        <a href="#ref137">Advanced Encryption Standard competition<sup>[137]</sup></a>. 
                        A reduced 12 round variant of Salsa20 (Salsa20/12) by Daniel J. Bernstein was selected for the 
                        <a href="#ref138">eSTREAM software portfolio<sup>[138]</sup></a>. 
                        The full 20 round variant of Salsa20 was chosen for additional security. 
						Two random 256 bit keys are generated using the TRNG at export time. One key is used for AES-CTR 
						and the other for Salsa20. A different nonce is used for each one-time pad to be encrypted in the 
						database. The design Exclusive ORs (XORs) the AES-CTR keystream and the Salsa20 keystream 
						together then XORs the combined keystream with the plaintext one-time pad.
					</p>
					<p>
						The reason a cascade of two stream ciphers is used is because there may be secret cryptanalytic 
						techniques against a cipher such as AES when it's used to encrypt something on its own. A 
                        recent publication of the Snowden documents revealed that 
                        <a href="#ref18">NSA have their own in-house (non public) cryptanalytic techniques
                        against AES and other ciphers<sup>[18]</sup></a>. 
						While a trivial reversal of a strong cipher without any additional information is highly 
						unlikely and would be indicative of the algorithm being very weak, it may be more likely that a single 
                        encryption algorithm <a href="#ref140">becomes vulnerable<sup>[140]</sup></a> to NSA when they 
						have access to <a href="#ref139">known plaintext<sup>[139]</sup></a> or 
						<a href="#ref141">chosen plaintext<sup>[141]</sup></a> encrypted by the algorithm as well.
					</p>
					<p>
						With a stream cipher cascade, the separate keystreams are XORed together. There is no way to 
						determine which bits belong to each cipher's keystream if each cipher is suitably strong on 
						their own. Even if there is a cryptanalytic break in AES, 
						an attacker does not have access to the raw keystream created by the AES algorithm because 
						there is still plaintext and the Salsa20 keystream mixed in with it. Even if an attacker knows 
						a lot of the plaintext they still won't be able to decrypt the AES layer of encryption because 
						the layer underneath is a random Salsa20 keystream which they do not know. Likewise if they 
						tried to decrypt the Salsa20 encryption layer first, the next layer is a random AES keystream 
						so they would not even know when they have decrypted the first layer correctly. The best 
						remaining attack against a stream cipher cascade may be a brute force of both keys which would 
						take a very long time.
					</p>
					<p>
						The following describes the encryption for the database:
					</p>
					<div class="formulas">
						<b>Key<sub>1</sub></b> &#8592; A 256 bit random key for AES-CTR generated by the TRNG<br>
						<b>Key<sub>2</sub></b> &#8592; A different 256 bit random key for Salsa20 generated by the TRNG<br>
						<b>Nonce<sub>1</sub></b> &#8592; A unique 96 bit nonce for AES-CTR, changing for each database row (one-time pad) to be encrypted<br>
						<b>Nonce<sub>2</sub></b> &#8592; A unique 64 bit nonce for Salsa20, changing for each database row (one-time pad) to be encrypted<br>
						<b>Counter<sub>1</sub></b> &#8592; A 32 bit counter for AES-CTR, starting at 0 for each database row and incrementing by 1 for each block being encrypted<br>
						<b>Counter<sub>2</sub></b> &#8592; A 64 bit counter for Salsa20, starting at 0 for each database row and incrementing by 1 for each block being encrypted<br>
						<b>One-Time Pad</b> &#8592; The last 1480 bits of the one-time pad to be encrypted and stored in the database. The public 56 pad identifier at the beginning is not encrypted.<br>
						<br>
						<b>Keystream<sub>1</sub></b> &#8592; <i>AES-CTR</i>( <i>Key<sub>1</sub></i>, <i>Nonce<sub>1</sub></i>, <i>Counter<sub>1</sub></i> )<br>
						<b>Keystream<sub>2</sub></b> &#8592; <i>Salsa20</i>( <i>Key<sub>2</sub></i>, <i>Nonce<sub>2</sub></i>, <i>Counter<sub>2</sub></i> )<br>
						<br>
						<b>Row Cascade Encryption</b> &#8592; <i>Keystream<sub>1</sub></i> &oplus; <i>Keystream<sub>2</sub></i> &oplus; <i>One-Time Pad</i><br>
						<b>Row Cascade Decryption</b> &#8592; <i>Ciphertext One-Time Pad</i> &oplus; <i>Keystream<sub>2</sub></i> &oplus; <i>Keystream<sub>1</sub></i><br>
					</div>
					<ul>
						<li>
							The reason to encrypt each row individually rather than encrypting the entire database at 
							once is for performance. Also in the upcoming version 2.0 of the program the database will 
							always be encrypted on disk, so it is advantageous to only have the small keys in memory and 
							decrypt each row as needed then delete the row.
						</li>
						<li>
							The keys remain the same for the entire database but the nonce changes for each database row 
							to be encrypted. The keys for encryption and authentication are obtained from slicing the 
							required number of bits off the beginning of the TRNG generated random data. This ensures 
							the keys are not used for anything else and the one-time pads are generated from the 
							remaining random data.
						</li>
						<li>
							Because AES in Counter Mode does not need a random IV, a unique nonce is used for 
							encrypting each row. Each one-time pad has an index number in the database starting from 0 
							up to the number of pads in the database. One user might have index numbers from 0 - 1000 in 
							their set of one-time pads and the next user might have index numbers from 1001 to 2000 in 
							their set. This ensures there is a unique index number for each row in the database. This 
							number is converted to hexadecimal and left padded with 0 bytes (<code>00</code> in hexadecimal) 
							up to 96 bits in length. The block counter for AES is 32 bits in length starting at 0 
							(<code>00000000</code> in hexadecimal) for each row and increments by 1 for each subsequent 
							block being encrypted.
						</li>
						<li>
							The nonce for Salsa20 is 8 bytes, so the pad index number is is converted to hexadecimal 
							and left padded with 0 bytes (<code>00</code> in hexadecimal) up to 64 bits in length. The 
							block counter for Salsa20 is also 8 bytes starting at 0 (<code>0000000000000000</code> in 
							hexadecimal) for each row and increments by 1 for each subsequent block being encrypted.
						</li>
						<li>
							The first 56 bits of a one-time pad is the pad identifier which is public and used to 
							lookup the correct pad in the database when another user sends a message. The pad 
							identifier is not encrypted and removed prior to encryption so only the remaining 1480 bits 
							of the random pad are encrypted. This removes any remaining known plaintext for an attacker 
							if they attempt to decrypt one of the one-time pads.
						</li>
						<li>
							There is some pad database information which is stored in the client database as well 
							(program version, custom user preferences, server address, server key, user callsign and 
							list of group user nicknames). This is JSON encoded to a string and encrypted with the same 
							database keys, but the static 96 bit nonce <code>ffffffffffffffffffffffff</code> in hexadecimal 
							for AES-CTR and the static 64 bit nonce <code>ffffffffffffffff</code> for Salsa20 is used for 
							encryption. Because each pad index number is converted to a nonce and in the language being 
							used integers cannot exceed 2<sup>53 - 1</sup> (9007199254740991), this nonce cannot be 
							accidentally be re-used for encrypting a pad, therefore it is used it to encrypt the pad 
							database information.
						</li>
					</ul>
					
					<h3 id="cascade-database-authentication"><span>13.2</span> Cascade database authentication</h3>
					<p>
                        Using the safe principles of 
						<a href="#ref142">Encrypt then MAC<sup>[142]</sup></a><a href="#ref143"><sup>[143]</sup></a>, 
                        the program creates a MAC of the database row 
						information including the encrypted one-time pad by using a cascade MAC. The chosen hash functions 
                        for this are <a href="#ref118">Keccak-512<sup>[118]</sup></a> with the capacity set 
                        at 1024 (same as the <a href="#ref144">finalised SHA3<sup>[144]</sup></a>) and 
                        <a href="#ref109">Skein-512<sup>[109]</sup></a>. Each MAC digest is calculated independently by 
						computing <span class="formulas"><i>Hash</i>(<i>Key</i> || <i>Data</i>)</span> with independent 
						keys for each algorithm. The resulting digests are then XORed together to hide the individual 
						MAC digests from independent cryptanalysis in case one of the algorithms has a flaw. Keccak and 
						Skein are newer hash functions that are not vulnerable to length extension attacks with this 
						simple MAC construct.
					</p>
					<p>
						The following describes the authentication for each row in the database:
					</p>
					<div class="formulas">
						<b>MAC Key<sub>1</sub></b> &#8592; A 512 bit random key for Keccak-512 generated by the TRNG<br>
						<b>MAC Key<sub>2</sub></b> &#8592; A different 512 bit random key for Skein-512 generated by the TRNG<br>
						<b>Nonce<sub>1</sub></b> &#8592; A unique 96 bit nonce based on the row index number which was used by AES-CTR to encrypt the one-time pad<br>
						<b>Nonce<sub>2</sub></b> &#8592; A unique 64 bit nonce based on the row index number which was used by Salsa20 to encrypt the one-time pad<br>
						<b>User Callsign</b> &#8592; The user callsign as a string (e.g. <code>alpha</code>, <code>bravo</code> etc) which this one-time pad is allocated to for sending<br>
						<b>Pad Identifier</b> &#8592; The first 56 bits of the one-time pad<br>
						<b>Ciphertext One-Time Pad</b> &#8592; The last 1480 bits of the one-time pad which is encrypted by AES-CTR and Salsa20<br>
						<br>
						<b>MAC<sub>1</sub></b> &#8592; Keccak-512( <i>MAC Key<sub>1</sub></i> || <i>Nonce<sub>1</sub></i> || <i>Nonce<sub>2</sub></i> || <i>User Callsign</i> || <i>Pad Identifier</i> || <i>Ciphertext One-Time Pad</i> )<br>
						<b>MAC<sub>2</sub></b> &#8592; Skein-512( <i>MAC Key<sub>2</sub></i> || <i>Nonce<sub>1</sub></i> || <i>Nonce<sub>2</sub></i> || <i>User Callsign</i> || <i>Pad Identifier</i> || <i>Ciphertext One-Time Pad</i> )<br>
						<br>
						<b>Row Cascade MAC</b> &#8592; <i>MAC<sub>1</sub></i> &oplus; <i>MAC<sub>2</sub></i><br>
					</div>
					<ul>
						<li>
							The resulting MAC tag is stored along with the other information for each row. When the 
							database is being loaded on a client machine, the program will calculate the MAC again 
							for each database row and verify that the hash digest matches the stored MAC tag for the row. 
							If there is a match for each row then no tampering has occurred, otherwise a warning will be 
							shown to the user. If the warning is shown, then the user should abandon the database of 
							one-time pads and look to transfer a new set.
						</li>
						<li>
							In this version of the program, the database is verified only when loading the pads initially 
							after they have been exported and transported. Currently after the pads are verified and 
							decrypted, the database is saved to the client PC in an unencrypted state. Running the 
							application and browser profile from inside a TrueCrypt volume is still recommended for this 
							release to keep the one-time pads encrypted locally on the disk. In the future, version 2.0 
							of the program will have the one-time pad database be fully encrypted and authenticated at 
							all times. Each one-time pad row will need to be verified and decrypted before sending or 
							receiving a message. The reason for why this functionality is not available in this version 
							is that the application needs to be converted to a Single Page Application first. Currently 
							each web page is run separately and there is no in memory data sharing between pages. 
							Converting to a single page application will reduce code duplication and mean the master 
							password only needs to be entered once on startup, not once for each page opened.
						</li>
						<li>
							The pad database information which is stored in the client database (program version, 
							custom user preferences, server address, server key, user callsign and list of group user 
							nicknames) is also authenticated using the same cascade MAC. This is checked before 
							decrypting and importing the pad database information. In version 2.0 it will be verified 
							each program load to ensure database integrity.
						</li>
					</ul>
					
					<h3 id="database-index-authentication"><span>13.3</span> Database index authentication</h3>
					<p>
						The program also creates a MAC of the database index for each user's set of one-time pads 
						by combining the pad index numbers for each row and then creating a cascade MAC. This 
						ensures that the all user's one-time pads in the database have not been added, swapped, 
						reordered, removed or otherwise tampered with. 
					</p>
					<p>
						The following describes the database index MAC:
					</p>
					<div class="formulas">
						<b>MAC Key<sub>1</sub></b> &#8592; A 512 bit random key for Keccak-512 generated by the TRNG<br>
						<b>MAC Key<sub>2</sub></b> &#8592; A different 512 bit random key for Skein-512 generated by the TRNG<br>
						<b>User Callsign</b> &#8592; The user callsign (e.g. 'alpha', 'bravo', 'charlie' etc) of the set of pads being authenticated<br>
						<b>Pad Index Number</b> &#8592; The index number of the row in the database for the user's set of pads<br>
						<br>												
						<b>MAC<sub>1</sub></b> &#8592; Keccak-512( <i>MAC Key<sub>1</sub></i> || <i>User Callsign</i> || <i>Pad Index Number<sub>0</sub></i> || <i>Pad Index Number<sub>1</sub></i> || <i>Pad Index Number<sub>2</sub></i> || ... )<br>
						<b>MAC<sub>2</sub></b> &#8592; Skein-512( <i>MAC Key<sub>2</sub></i> || <i>User Callsign</i> || <i>Pad Index Number<sub>0</sub></i> || <i>Pad Index Number<sub>1</sub></i> || <i>Pad Index Number<sub>2</sub></i> || ... )<br>
						<br>
						<b>Index Cascade MAC</b> &#8592; <i>MAC<sub>1</sub></i> &oplus; <i>MAC<sub>2</sub></i><br>
					</div>
					<ul>
						<li>
							When a message is received or sent that pad is deleted from the database so the pad index 
							MAC needs to be updated every time a new message is received or sent. This functionality 
							will be added in version 2.0 when the database will be encrypted and authenticated at all 
							times. At the moment in this version, the full verification of the index is only performed 
							as part of the initial importing of the one-time pads after transportation. This is 
							mainly to verify that the transfer took place without tampering. Version 2.0 will be much 
							more comprehensive and ensure that the database integrity and authenticity is valid at all 
							times.
						</li>
						<li>
							Including the user callsign in the MAC means that an attacker cannot swap out one-time pads 
							from one user into another user's set of pads, forcing a two-time pad situation and allowing 
							cryptanalysis.
						</li>
					</ul>
					
					
					<h2 id="database-key-wrapping"><span>14</span>Protection of database encryption and authentication keys</h2>
					<p>
						The actual database encryption and authentication keys which were generated by the TRNG are 
						stored in inside the database with the rest of the other information. To protect these keys 
                        while they reside in unprotected storage a simple <a href="#ref145">key wrapping<sup>[145]</sup></a>
                        construction is used.
					</p>
					
					<h3 id="database-pbkdf"><span>14.1</span>Database master key derivation</h3>
					<p>
						To encrypt the actual database encryption and authentication keys, a master key is created 
						by deriving it from a password, two salts and two separate PBKDFs. The current PBKDFs are a 
						temporary measure until there is library support for 
						<a href="#ref151">Argon2<sup>[151]</sup></a> which was the winner in the 
						<a href="#ref152">Password Hashing Competition<sup>[152]</sup></a>. A good fallback 
						solution would have been to use <a href="#ref153">bcrypt<sup>[153]</sup></a> or 
						<a href="#ref154">scrypt<sup>[154]</sup></a> which use lots of memory as well but there is no 
						verifiable library support for these functions in the programming language being used.<br>
						<br>						
						The following describes the cascade PBKDF construction:
					</p>
					<div class="formulas">
						<b>Password</b> &#8592; A strong password/passphrase entered by the user<br>
						<b>Salt<sub>1</sub></b> &#8592; A 768 bit random salt generated by the TRNG to be used with the Keccak PBKDF<br>
						<b>Salt<sub>2</sub></b> &#8592; A different 768 bit random salt generated by the TRNG to be used with the Skein PBKDF<br>
						<b>Keccak Iterations</b> &#8592; The number of iterations to be performed by the Keccak PBKDF with the default set at 10,000<br>
						<b>Skein Iterations</b> &#8592; The number of iterations to be performed by the Skein PBKDF with the default set at 10,000<br>
						<br>
						<b>Intermediate Key</b> &#8592; PBKDF2-Keccak-512( <i>Password</i>, ( <i>Salt<sub>1</sub></i> || <i>Keccak Iterations</i> ), <i>Keccak Iterations</i> )<br>
						<b>Master Key</b> &#8592; PBKDF-Skein-512( <i>Intermediate Key</i>, ( <i>Salt<sub>2</sub></i> || <i>Skein Iterations</i> ), <i>Skein Iterations</i> )
					</div>
					<ul>
						<li>
                            The first PBKDF is <a href="#ref146">PBKDF2<sup>[146]</sup></a> with the 
                            Keccak-512 hash function. The output key size is set at 512 bits, the default number of 
							iterations is set at 10,000 and a 768 bit random salt which was generated by the TRNG is 
							used.
						</li>
						<li>
                            <a href="#ref147">Keccak can be used in conjunction with HMAC<sup>[147]</sup></a> 
                            which is what PBKDF2 uses internally. The reason to use Keccak instead of 
                            <a href="#ref148">SHA-2<sup>[148]</sup></a> is because it is a 
                            newer hash function and it is not designed by the NSA. Anything designed by the NSA is avoided 
                            by this program in case it has deliberate secret weaknesses that are unknown to the academic 
                            community. An algorithm designer is in the best position to design an algorithm 
							with a subtle weakness. In the case of SHA-2 a weakness may not be discovered for many years if 
                            academia is well behind the state of the art in cryptography.
							
							We know at one point <a href="#ref149">the NSA were 20 years ahead in cryptography<sup>[149]</sup></a> 
                            when they knew about differential cryptanalysis before anyone else. They are likely still 
                            ahead by a large margin. Using Keccak which was the winner in an open competition and which 
                            has a design which is completely open is considered much safer. In comparison to SHA-2, Keccak 
                            should provide better entropy in the derived key, however it may be a lot faster in hardware 
                            which would provide a slightly better advantage for an attacker performing a brute force attack.
							
                            However the main attacker to be considered is the NSA and we can reasonably assume they have dedicated 
                            <a href="#ref150">ASICs<sup>[150]</sup></a> and other hardware for cracking password hashes 
							which were derived using the most commonly used PBKDFs simply because everyone in the world is 
							using those algorithms. By using the newer Keccak algorithm this essentially forces the NSA 
							to expend more money building new dedicated ASICs or re-engineer their supercomputer code 
							just to crack an encrypted database created by this program. Even then they would still need 
							physical access to the encrypted database so they might not even bother trying.
						</li>
						<li>
							The second PBKDF uses the Skein hash function. The output key size is set at 512 bits, the 
							default number of iterations/repetitions is set at 10,000 and a separate 768 bit random salt 
							which was generated by the TRNG is used. The resulting 512 bit <i>Intermediate Key</i> from 
							the previous PBKDF2-Keccak function is passed in as the <i>Password</i> for this function.
						</li>
						<li>
                            The Skein PBKDF method is described in 
							<a href="#ref155">Section 4.8 of The Skein Hash Function Family</a> specification 
							document. Quoting the document:<br>
							<i>"The application stores a random seed S, asks the user for a password P, and then 
							performs a long computation to combine S and P." ... "An even simpler PBKDF is to simply create 
							a very long repetition of S and P; e.g., S || P || S || P || S ..., and hash that using Skein. 
							(Any other optional data can also be included in the repetition.) This approach is not ideal 
							with a normal hash function, as the computation could fall into a loop. But in Skein, every 
							block has a different tweak and is thus processed differently."</i>
						</li>
						<li>
							For added security an option exists in the user interface to use custom iteration counts. 
							The user can decrease the number of iterations for slower portable devices and use a longer 
							password to compensate. The user may also choose to increase the iteration counts to make 
							the database more resilient to attack. The default of 10,000 iterations for each of the 
							PBKDFs is a good balance between strength and slow speed of the JavaScript runtime engine.
						</li>
						<li>
							The user can also choose not store the number of Keccak or Skein iterations with the rest of 
							the database. The user would remember the iterations or write them down separately on a 
							piece of paper. This may be useful if passing through airport security and there is a high 
							likelihood of the data being confiscated and copied. This forces an attacker with only the 
							database to try every iteration count for every password permutation. To counter an attacker 
							simply caching the results of previous iteration counts and running the PBKDF on one password 
							at a time, the number of iterations are appended to the end of the salt at runtime. This 
							forces the attacker to do the full PBKDF iterations for every reasonable iteration count 
							the user could have chosen e.g. 1 - 10,000+ then repeat that for all possible password 
							permutations.
						</li>
						<li>
							The total length of the two salts is the same length of all the database keys (256 bits 
							AES-CTR + 256 bits Salsa20 + 512 bits Keccak + 512 bits Skein) which adds up to 1536 bits. 
							Each 768 bit salt is fed into a different PBKDF. Normally passwords do not contain much 
							entropy, so the salts which are randomly generated by the TRNG are used as a backup to add 
							additional entropy to safely secure the database keys.
						</li>
						<li>
							Another option exists in the user interface to store the two 768 bit salts (1536 bits 
							concatenated together) as a separate keyfile. The advantage of this is to store the 
							keyfile on a separate storage device (e.g. MicroSD card) or written down on a piece of paper 
							which can be easily hidden if the database is at risk of being compromised in transit. If 
							an attacker can confiscate or steal the primary device (e.g. notebook PC) which has the 
							encrypted database but can't find the keyfile as well then it is practically impossible to 
							crack the database encryption in any reasonable timeframe. Future versions may allow this 
							keyfile to be hidden inside an image file using steganography.
						</li>
					</ul>
					
					<h3 id="subkey-derivation"><span>14.2</span>Sub key derivation</h3>
					<p>
						Four sub keys are derived from the master key and are used to encrypt the actual database 
                        encryption and authentication keys. This is basically a simple 
                        <a href="#ref156">KDF2<sup>[156]</sup></a> construction but uses a cascade of two hash functions for each 
						counter value to protect against flaws in either algorithm. The newer hash functions used are 
						already secure against <a href="#ref157">length extension attacks<sup>[157]</sup></a> and 
                        do not need <a href="#ref197">HMAC<sup>[197]</sup></a>. The following describes the cascade sub key derivation:
					</p>
					<div class="formulas">
						<b>Master Key</b> &#8592; The 512 bit master key derived from the cascade PBKDF used earlier<br>
						<b>Counter<sub>i</sub></b> &#8592; A 32 bit numeric counter to be combined with the hash function e.g. (<code>00000001</code>, <code>00000002</code>, ... in hexadecimal)<br>
						<br>
						<b>Derived Key<sub>1</sub></b> &#8592; Keccak-512( <i>Master Key</i> || <i>Counter</i><sub>1</sub> ) &oplus; Skein-512( <i>Master Key</i> || <i>Counter</i><sub>1</sub> )<br>
						<b>Derived Key<sub>2</sub></b> &#8592; Keccak-512( <i>Master Key</i> || <i>Counter</i><sub>2</sub> ) &oplus; Skein-512( <i>Master Key</i> || <i>Counter</i><sub>2</sub> )<br>
						<b>Derived Key<sub>3</sub></b> &#8592; Keccak-512( <i>Master Key</i> || <i>Counter</i><sub>3</sub> ) &oplus; Skein-512( <i>Master Key</i> || <i>Counter</i><sub>3</sub> )<br>
						<b>Derived key<sub>4</sub></b> &#8592; Keccak-512( <i>Master Key</i> || <i>Counter</i><sub>4</sub> ) &oplus; Skein-512( <i>Master Key</i> || <i>Counter</i><sub>4</sub> )<br>
					</div>
					<ul>
						<li>
							A simple KDF2 construct to get encryption and authentication keys from a master key would 
							apply the hash function twice. Once with the <i>Master Key</i> and a unique <i>Counter</i> 
							(e.g. <code>01</code>) to make an encryption key, and again with the <i>Master Key</i> and another unique 
							<i>Counter</i> (e.g. <code>02</code>) to gain a unique MAC key. If the keys used for encryption is compromised 
							it is computationally hard to find a pre-image for the one-way hash function to determine 
							the <i>Master Key</i> or the derived MAC key. Similarly if the MAC key is compromised it is 
							hard to reverse the process to find the <i>Master Key</i> or encryption key. This cascade construct 
							performs two hashes for each derived key, once using Keccak on the <i>Master Key</i> and 
							unique <i>Counter</i>, then again with the Skein algorithm and another unique <i>Counter</i>. 
							Finally it XORs the resulting random hash digests together to produce the derived key. This 
							adds additional assurances that the derived key will not be easily reversed if there is a 
							flaw in either algorithm discovered in the future.
						</li>
						<li>
							The resulting derived keys are 512 bits in length. The first and second derived keys are 
							used for AES-CTR and Salsa20. Because the key lengths for these encryption algorithms are 
							only 256 bits in length, these two derived keys are truncated to just the first 256 bits. 
							The third and fourth derived keys which are used for Keccak and Skein remain at 512 bits.
						</li>
					</ul>
					
					<h3 id="encryption-and-authentication-of-database-keys"><span>14.3</span> Encryption and authentication of database keys</h3>
					<p>
						The following describes the encryption and authentication of the actual database keys using the 
						derived keys from earlier:
					</p>
					<div class="formulas">
						<b>Database Keys</b> &#8592; The actual AES-CTR, Salsa20, Keccak and Skein database keys, concatenated together<br>
						<b>Nonce<sub>1</sub></b> &#8592; A static 96 bit nonce for AES-CTR (<code>000000000000000000000000</code> in hexadecimal)<br>
						<b>Nonce<sub>2</sub></b> &#8592; A static 64 bit nonce for Salsa20 (<code>0000000000000000</code> in hexadecimal)<br>
						<b>Counter<sub>1</sub></b> &#8592; A 32 bit counter for AES-CTR, starting at 0 and incrementing by 1 for each block being encrypted<br>
						<b>Counter<sub>2</sub></b> &#8592; A 64 bit counter for Salsa20, starting at 0 and incrementing by 1 for each block being encrypted<br>
						<br>
						<b>Keystream<sub>1</sub></b> &#8592; <i>AES-CTR</i>( <i>Derived Key<sub>1</sub></i>, <i>Nonce<sub>1</sub></i>, <i>Counter<sub>1</sub></i> )<br>
						<b>Keystream<sub>2</sub></b> &#8592; <i>Salsa20</i>( <i>Derived Key<sub>2</sub></i>, <i>Nonce<sub>2</sub></i>, <i>Counter<sub>2</sub></i> )<br>
						<b>Encrypted Database Keys</b> &#8592; <i>Keystream<sub>1</sub></i> &oplus; <i>Keystream<sub>2</sub></i> &oplus; <i>Database Keys</i><br>
						<br>
						<b>MAC<sub>1</sub></b> &#8592; Keccak-512( <i>Derived Key<sub>3</sub></i> || <i>Encrypted Database Keys</i> )<br>
						<b>MAC<sub>2</sub></b> &#8592; Skein-512( <i>Derived Key<sub>4</sub></i> || <i>Encrypted Database Keys</i> )<br>
						<b>Cascade MAC</b> &#8592; <i>MAC<sub>1</sub></i> &oplus; <i>MAC<sub>2</sub></i><br>
					</div>
					<ul>
						<li>
							After encryption and authentication, the encrypted database keys and the Cascade MAC are stored 
							in the database. To decrypt the database, a user will enter their password, load the keyfile and 
							set the number of iterations. It will perform the same steps above to generate the derived Keccak 
							and Skein keys, recreate the MAC against the stored encrypted database keys, then match that 
							against the stored MAC. Any incorrect match may mean an incorrect password, keyfile or number 
							of iterations used. Alternatively, if the password, keyfile or number of iterations is correct 
							it could indicate a more serious matter such as database corruption or that someone has 
							tampered with the database.
						</li>
					</ul>
															
					
					<h2 id="using-html5"><span>15</span> Using HTML5</h2>
					<p>
						Thomas Ptacek's article, <a href="#ref158">Javascript Cryptography Considered Harmful<sup>[158]</sup></a> 
						raises a valid point about JavaScript code being delivered by the web server being insecure 
						against MITM attacks. The article in general however is now outdated and blanket statements 
						saying that all JavaScript cryptography is harmful is misleading and inaccurate. In reality, 
						there are <a href="#ref159">sensible<sup>[159]</sup></a> and 
						<a href="#ref160">secure<sup>[160]</sup></a> solutions to the problems raised and all of 
						his other concerns <a href="#ref161">have been reasoned and mitigated<sup>[161]</sup></a> as 
						well.
					</p>
					<p>
						In summary, most points they made are not applicable for this program due to the fact that the 
						source code is downloaded as a signed <a href="#ref162">.tar.gz<sup>[162]</sup></a> 
						archive file and users are expected to verify the file's GPG signature with the one from this website to 
						ensure its authenticity. From there the code should be run <i>locally</i> from the machine by going to 
						the directory and running index.html which will load the website and code into the browser. This means all 
						code is always running locally from the local hard drive and the web address will be similar to 
						<code>file:///media/truecrypt1/jericho/client/index.html</code>. All the executable code is self 
						contained and does not rely on any server delivered JavaScript at all. It essentially becomes a 
						regular client side application except it runs inside a browser to make use of the browser's 
						rendering and JavaScript runtime engines. This itself mitigates the majority of the problems 
						the Matasano Security article raised.
					</p>
					<p>
						HTML5 has more advantages than disadvantages. It's easier and faster to develop with. New APIs 
						allow for <a href="#ref115">cryptography<sup>[115]</sup></a>, 
						<a href="#ref163">persistent database storage<sup>[163]</sup></a>, 
						<a href="#ref164">messaging<sup>[164]</sup></a> and 
						<a href="#ref165">file management<sup>[165]</sup></a>. Browsers are first in line for security 
						updates and the best ones are open source and trustworthy. People rely on browsers to have good security 
						to do their Internet banking and shopping online. The source code does not need to be compiled. 
						You can verify the source code being run live in the browser using Chromium or Firefox built-in Web 
						Development tools or with browser add-ons like <a href="#ref166">Firebug<sup>[166]</sup></a>. This 
						allows you to verify the code is doing exactly what it should be. HTML5 is cross platform, one 
						code base can literally run on Windows, Linux, Mac, phones and tablets simply with the latest 
						web browser. One of the goals of the project is to get a truly secure chat program functioning 
						on an open hardware platform and an open operating system like 
						<a href="#ref167">Firefox OS<sup>[167]</sup></a>. This is a true open source OS for 
						smartphones and tablets from a reputable organisation that believes that 
						<a href="#ref168">individuals' security and privacy on the Internet is fundamental<sup>[168]</sup></a>.
					</p>
					<p>
						Currently this program has been tested to work in the latest versions of the open source browsers 
						<a href="#ref169">Firefox<sup>[169]</sup></a> and <a href="#ref170">Chromium<sup>[170]</sup></a>. 
						Some of the other popular browsers have not implemented the Web Crypto API 
						yet. The layout is responsive and will work on desktops and tablets. Some more work and testing 
						is still required to get it working nicely on mobile. In particular a method to 
						load the one-time pads into the program using later versions of Android. Using Firefox is 
						recommended as they are open source and are not involved in the 
						<a href="#ref171">PRISM surveillance program<sup>[171]</sup></a>. Unfortunately nobody can say 
						for sure about that with Google so the proprietary Google Chrome browser is not recommended. 
						Firefox is still preferred in comparison to Chromium as 
						<a href="#ref172">Google were recently caught out<sup>[172]</sup></a> trying to backdoor it 
						with a closed source binary which captured audio from the microphone. There's nothing stopping 
						them from trying similar stunts in future unless users are watching closely for these issues.
					</p>
					<p>
						It is recommended to <a href="#ref173">create a new browser profile<sup>[173]</sup></a> inside a 
						<a href="#ref53">TrueCrypt<sup>[53]</sup></a> volume to protect the one-time pads when 
						they are stored inside the browser storage. In a future version of the program it will keep the 
						one-time pad database encrypted locally at all times.
					</p>
					<p>					
						The main crypto library this program uses is <a href="#ref174">CryptoJS<sup>[174]</sup></a>. 
						There were some other libraries that would be good to use but they either did not work in a 
						<a href="#ref175">HTML5 Web Worker<sup>[175]</sup></a> which makes 
						CPU intensive cryptographic functions take significantly longer and 
						<a href="#ref176">blocks<sup>[176]</sup></a> the user interface thread, or their outputs couldn't be verified 
						from the reference test vectors. It is important to verify that the code can produce the same 
						hash outputs as the test vectors from the specification documents. This ensures the program is 
						not using a faulty or backdoored version of the algorithm that gives incorrect results.
					</p>
					
					
					<h2 id="json-rest-api"><span>16</span> REST API using JSON</h2>
					<ul>
						<li>
							The client browsers communicate to and from the server using JSON and the 
							REST API on the server. The server side code is currently written for the latest version of 
							PHP 5.x using best security practices for protection against 
							<a href="#ref179">SQL injection<sup>[179]</sup></a> and other attacks. This will likely be 
							rewritten in a different language in the next release e.g. 
							<a href="#ref178">NodeJS<sup>[179]</sup></a> to have a common cryptographic library base 
							across the client and server. This will allow for a simple integration of the data 
							encryption between the clients and server in order to hide the 
							<a href="#ref180">metadata<sup>[180]</sup></a>.
						</li>
						<li>
							The server sends <a href="#ref177">CORS<sup>[177]</sup></a> HTTP headers so that the client 
							browsers can connect and make a cross-origin request. This is 
							needed because the program is run locally from the <code>file:///</code> location and not 
							served by a webserver. If the JavaScript code was served from a web server it could let an 
							attacker perform a MITM attack and alter the code, this could then make the user send 
							unencrypted messages and they would not be any wiser.
						</li>
						<li>
							For now the browsers use an <a href="#ref181">AJAX<sup>[181]</sup></a> 
							request to send/receive data to/from the server. The reason for this is that the chat can be delayed 
							like email (encrypted messages remain on the server until they are received), or real-time if users 
							are connected at the same time. If a user is connected it will check for new messages from the server 
							every 3 seconds which is fast enough to appear as real-time and does not stress the server too much.
						</li>
					</ul>
					<p>
						A summary of the request/response protocols are shown below:
					</p>
					
					<h3 id="api-send-message"><span>16.1</span> Send message</h3>
					<p>
						This is the request the client makes when sending a message.
					</p>
					<p>
						<img class="listImage" src="img/api-send-message-json.png">
					</p>
					
					<h3 id="api-send-message-response"><span>16.2</span> Send message server response</h3>
					<p>
						This is the response the server makes after it has received a request to send a message.
					</p>
					<p>
						<img class="listImage" src="img/api-send-message-server-response-json.png">
					</p>
					
					<h3 id="api-receive-messages"><span>16.3</span> Receive messages request</h3>
					<p>
						This is the request each client makes every 3 seconds. This will get any new messages from the server 
						for the user making the request.
					</p>
					<p>
						<img class="listImage" src="img/api-receive-messages-json.png">
					</p>
					
					<h3 id="api-receive-messages-response"><span>16.4</span> Receive messages response</h3>
					<p>
						This is the response the server will make after receiving a request from a client for retrieving new messages.
					</p>
					<p>
						<img class="listImage" src="img/api-receive-messages-response-json.png">
					</p>
					
					<h3 id="api-auto-nuke"><span>16.5</span> Initiate self destruct request</h3>
					<p>
						This is the request a client makes if they want to wipe the all the other chat group user's 
						local one-time pad databases. It is very disruptive and designed for use only in an emergency. 
						This command is sent encrypted and authenticated via the secure message channel. This is so 
						only a valid user with the set of one-time pads can trigger an auto nuke. An attacker with 
						access to the server cannot change anything to trigger the chat group users to delete 
						their local databases in order to disrupt communications.
					</p>
					<p>
						To trigger the request, the user will visit a separate screen in the user interface and click 
						a button. The client will automatically send a regular message with the string code 
						<code>init auto nuke</code>. This will be encrypted with one of the one-time pads, authenticated 
						with the MAC and sent to the server like a regular message. The initiating user's current local 
						database of one-time pads will then be wiped and their screen cleared.
					</p>
					
					<h3 id="api-auto-nuke-response"><span>16.6</span> Self destruct initiated response</h3>
					<p>
						If a chat group user is checking for new messages and an authentic message comes through with the 
						code <code>init auto nuke</code>, instead of continuing to receive and process new messages, the 
						user's client will show a notification that the self destruct has been initiated by the user who 
						initiated it, then the program will immediately wipe their local database of any data and clear 
						the screen of any sent or received messages.
					</p>
					<p>
						After all users have had their local databases wiped, the server database of one-time pads can 
						be cleared by the server administrator. There is no real risk in leaving the encrypted messages 
						on the server for a longer period of time as every one-time pad encrypted message has 
						information-theoretic security and plausible deniability. 
					</p>
					
					
					<h2 id="message-encoding"><span>17</span> Message encoding</h2>
					<p>
						Each one-time pad is made up of 192 bytes which is 384 hexadecimal symbols or 1536 binary digits. See the 
						table below for more information:
					</p>
					<p class="diagram">
						<img src="img/pad-encoding.png">
					</p>
					<p>
						Each message is made up of three main parts, the pad identifier, the message parts and the message authentication code. The 
						one-time pad is used to encrypt the message parts and the MAC tag.
					</p>
					<p class="diagram">
						<img src="img/message-encoding.png">
					</p>			
					<p>
						This can be further broken down to the individual message parts. See below for the length of each part:
					</p>
					<p class="diagram">
						<img src="img/message-encoding-full.png">
					</p>
					<ul>
						<li>
							At the moment the program only supports messages typed using the 
							<a href="#ref182">ASCII printable character set<sup>[182]</sup></a>. 
							This is all the characters you can see on a standard US keyboard. In practicality 
							this limits the languages that can be used to English and ones that use the 
							<a href="#ref183">basic Latin alphabet<sup>[183]</sup></a> e.g. Dutch, German, French, 
							Indonesian, Portuguese and Spanish but without the 
							<a href="#ref184">diacritical marks<sup>[184]</sup></a>. This is for ease of development at 
							the moment and the program will support other languages with proper 
							<a href="#ref185">UTF-8<sup>[185]</sup></a> encoding and decoding in the future.
						</li>
						<li>
							All messages that are sent/received are encoded to hexadecimal format first which is just stored 
							in a normal JavaScript string. This is to make transport using JSON easier rather than trying to 
							send UTF-8 encoded data over the wire. A hexadecimal symbol 
							(<a href="#ref188">Nibble<sup>[188]</sup></a>) is 4 bits, and two hexadecimal symbols 
							makes 8 bits (one <a href="#ref189">Octet/Byte<sup>[189]</sup></a>) 
							and can be represented as a single ASCII character.
						</li>
						<li>
							The <b>Pad identifier</b> is the first 7 bytes (56 bits) from the one-time pad. This identifies to 
							the receiver which pad should be used to decrypt the message. This is used rather than sending the 
							sequence number of the one-time pad to remain in sync with the other users as that could reveal to 
							an attacker the number of messages sent so far.
						</li>
						<li>
							The maximum message length has been set at 115 bytes (115 ASCII characters) for now. This is slightly 
							less than the size of a <a href="#ref190">tweet<sup>[190]</sup></a> 
							(140 characters) or an <a href="#ref191">SMS<sup>[191]</sup></a> (160 characters). This is 
							because generating enough random data takes a long time. Making a message length longer than that, 
							where the one-time pad may or may not be fully used is wasteful. If users need more than 115 
							characters they can simply send a second message. In future a new feature will be added to allow 
							a message to be spread over multiple one-time pads.<br>
							<br>
							If a message is less than 115 bytes in length it is padded to the right (up to the maximum 115 bytes) 
							with random bits generated from the Web Crypto API. This hides the actual length of the message to 
							frustrate any cryptanalysis. For example if no padding was added and the message was simply "hi" then 
							the ciphertext would be the same length which could aid the attacker. Of course there are a few other 
							words with only two letters which allows for some uncertainty. However if the message is padded up to the 
							full 115 bytes each time, then an attacker knows nothing about the true length of the message, 
							only that it is somewhere between 1 and 115 bytes long.<br>
							<img class="listImage" src="img/message-padding.png" alt="Message padding">							
						</li>						
						<li>
							The <b>Actual message length</b> is the true message length without any padding. It is an aid in the decryption 
							process so it can remove the correct number of padding bytes from the end of the message and reveal the original 
							plaintext automatically. This field is always 1 byte in length which is enough to represent the message length. 
							For example, if the message was 70 bytes long, then the number 70 is converted to binary and left padded (if necessary) 
							to be 8 bits long. 8 bits can have 2<sup>8</sup> (256) possible values which represents the numbers from 0 to 255. 
							One byte of information can store the actual message length of 1 to 115 bytes easily. The actual message length is 
							also encrypted with one byte from the one-time pad so it is impossible for an attacker to know the actual message 
							length without the one-time pad. An attacker only knows that the length of a message is between 1 and 
							115 bytes. When decrypting the message, the message length value is checked to make sure it is in the 
							correct range. This helps avoid <a href="#ref207">denial of service<sup>[207]</sup></a> (DOS) 
							and/or buffer overflow attacks.
						</li>
						<li>
							A UNIX timestamp is sent along with the message in the <b>Message sent timestamp</b> field 
							to signify when the message was sent from the sender's computer. This is converted to binary 
							and sent with the message packet. 5 bytes are reserved for this. It could 
							easily be 4 bytes (32 bits), but an extra byte was added to avoid the 
							<a href="#ref192">year 2038 problem<sup>[192]</sup></a>. 
							This timestamp is also encrypted with 5 bytes of the one-time pad. This prevents an attacker from 
							interfering with the date or time of the message which could be critical in some circumstances. It is 
							also used for correctly reordering messages on the client side when retrieving multiple messages from 
							the server. This prevents an attacker reordering messages from them gaining access to the server or by 
							delaying server responses.
						</li>
						<li>
							The final part of the encoding is the <b>MAC tag</b>. This MAC tag is sent along with each message for 
							authentication and integrity to ensure that the message has not been tampered with. The MAC tag is 
							also encrypted with part of the one-time pad so it is also information-theoretically secure. The 
							process is explained in depth further on.
						</li>
					</ul>
					
					
					<h2 id="encryption-process"><span>18</span> Message encryption process</h2>
					<ul>
						<li>
							The program first receives the plaintext message from the user from the text box when they click the 
							<i>Send message</i> button. 
						</li>
						<li>
							Then it does a lookup on the user's local database of one-time pads and selects the first available 
							one-time pad allocated to that user for sending messages. The one-time pads for sending/encrypting 
							messages are evenly pre-allocated and grouped under each user in the chat group e.g. alpha, bravo, 
							charlie etc. This prevents one user from encrypting a messsage using the same one-time pad as another 
							user.
						</li>
						<li>
							Once a one-time pad has been selected, it removes it from the local database and splits it into the pad 
							identifier, the message parts and the MAC parts. The encryption process is as follows:
						</li>
					</ul>
					<p class="diagram">
						<img src="img/encryption-process.png" alt="Encryption process">
					</p>
					<ul>
						<li>
							In step one, the plaintext with padding, the message length and the timestamp are converted to binary 
							and concatenated together.
						</li>
						<li>
							In step two, because some of the bits of the 40 bit UNIX timestamp can be predictable, this could leave 
							a <a href="#ref140">crib<sup>[140]</sup></a> for an attacker and they 
							could recover those few bits of the key. This however would not compromise the remainder of the plaintext 
							because each bit of the one-time pad is random and independent from the rest. For example, if the 
							timestamp was 1406440512 for 
							2014-07-27 at 5:55am in UTC then that would convert to binary as <code>00000000 01010011 11010100 10010100 01000000</code>. 
							If we compare another time in the future, 1503040500 for 2017-08-18 at 7:15am in UTC then that would 
							convert to binary as <code>00000000 01011001 10010110 10010011 11110100</code>. The first 12 bits are 
							the same in both timestamps even though the dates are years apart. This is because the timestamp field 
							is larger than currently required in order to future proof the protocol. If it was the usual 32 bits then 
							eventually there would be incorrect dates and times shown in the program after 
							<a href="#ref192">19 Jan 2038<sup>[192]</sup></a>.<br>
							<br>
							To remove this as a possibility for being a crib, the program randomly reverses the binary message parts 
							(including the plaintext with padding, the message length and the timestamp) depending on the second 
							last byte in the one-time pad. It does this by converting this byte to an integer value (0 - 255), 
							then uses that number modulo 2. This will return a random integer of 0 or 1. A one will mean the 
							message parts get reversed while a zero will mean they stay the same. This means that every message, 
							an attacker does not know for certain whether the timestamp is at the front or end of the message 
							parts. They also do not know whether the true plaintext begins at the start of the message or the end. 
							Because all users have the same one-time pad, they can reverse this transformation to get the message 
							parts back in proper order after decryption. This transformation has a similar purpose to 
							<a href="#ref193">Russian copulation<sup>[193]</sup></a>.
						</li>
						<li>
							In the third step, the <a href="#ref48">XOR<sup>[48]</sup></a> operation is what does the 
							encryption. Each bit of the plaintext is encrypted with a unique bit of the one-time pad. 
							With a truly random one-time pad the 
							<a href="#ref194">encryption is unbreakable even in theory<sup>[194]</sup></a>.
						</li>
						<li>
							The final step concatenates the pad identifier to the ciphertext message parts. The pad identifier helps 
							the other users determine which one-time pad was used to encrypt the message.
						</li>
						<li>
							Once the message has been encrypted, the MAC is created using a random MAC algorithm that was 
                            selected and then encrypted with part of the one-time pad. This process is explained further on. 
							The MAC is concatenated to the end of the ciphertext and sent with the message to the server. 
                            The server holds the message until all the other users have retrieved it.
						</li>
					</ul>
					
					
					<h2 id="decryption-process"><span>19</span> Message decryption process</h2>
					<p>
						The user first checks for encrypted messages on the server that are not sent by them and have not been 
						read already by them. This will retrieve all other messages sent by users in the same chat group. 
						Once the encrypted messages have been retrieved by the user, the messages are marked as read on the server 
						by them. Once all users have read the message, they are deleted from the server in a cleanup process which 
						runs every 30 seconds. The process for decryption is generally the same as encryption but in reverse order. 
						For each encrypted message that is received:
					</p>
					<ul>
						<li>
							The program selects the sender of the message e.g. alpha, bravo, charlie etc and does a lookup on the 
							local database of one-time pads for that user. The program selects the pad identifier (first 7 bytes) 
							from the ciphertext which will match the first 7 bytes from one of the one-time pads in the database. 
							The pad identifier for each one-time pad is stored in a separate field which makes searching faster. 
							It then retrieves the one-time pad for the message and takes off the pad identifier.
						</li>
						<li>
							The MAC is then decrypted with the last 64 bytes of the one-time pad. Using the ciphertext message 
							parts, the one-time pad and the random algorithm for the MAC, the MAC is calculated. If this matches 
							the MAC sent, then the message is valid and has not been tampered with. Decryption of the message 
							will follow. If the message matches the MAC sent with the message then an 'Authentic' status is 
							displayed to the user. If the message is not valid, the user is warned that tampering has occurred 
							and the decryption process will not be attempted.
						</li>
						<li>
							The one-time pad message parts is then XORed with the ciphertext message parts (including the 
							plaintext with padding, message length and timestamp). This returns the decrypted text with padding, 
							the actual message length and the time the message was actually sent.
						</li>
						<li>
							Depending on the second last byte of the key, the decrypted message parts are returned to their original 
							order (unreversed) if that transformation was made in the encryption process.
						</li>
						<li>
							The message length part is read and this gets the length of the actual message in bytes. Reading 
							from the start of the plaintext message up to the message length will retrieve the actual plaintext 
							without padding.
						</li>
						<li>
							The one-time pads for any messages received and verified authentic are then deleted from the user's 
							local database.
						</li>
					</ul>
	
					
					<h2 id="message-authentication"><span>20</span> Message Authentication Code</h2>
					<p>
						The one-time pad is vulnerable to a <a href="#ref195">bit-flipping attack<sup>[195]</sup></a> if 
						not authenticated with a MAC. Therefore the program calculates and sends a secure MAC with each 
						message. Both users have a shared secret, which is the one-time pad for each message so the MAC 
						can be calculated and verified by either person. This simple MAC construction is a temporary 
						solution which should be fine until there is time to write a more standardised one-time MAC 
						implementation based on the <a href="#ref187">Carter-Wegman MAC<sup>[187]</sup></a>.<br>
						<br>
						The construction of this MAC is as follows: 
					</p>
					<div class="formulas">
						<b>Random Number</b> &#8592; Get the last byte of the one-time pad used to encrypt the message e.g. 
						                       <code>7f</code> and convert it to an integer i.e. <code>127</code>.<br>
						<b>MAC Algorithms</b> &#8592; The list (array) of MAC functions available i.e. <code>[Skein-512, Keccak-512]</code>. Both produce a 512 bit output.<br>
						<b>Number of MAC Algorithms</b> &#8592; The number of MAC functions available i.e. 2.<br>
						<b>Ciphertext</b> &#8592; The pad identifier (56 bits) and ciphertext message parts (968 bits) concatenated together.<br>
						<b>Key</b> &#8592; The full one-time pad (1536 bits).<br>
						<b>MAC Encryption Key</b> &#8592; The last 512 bits of the full one-time pad reserved for encrypting the MAC tag.<br>
						<br>
						<b>MAC Algorithm Index</b> &#8592; <i>Random Number</i> % <i>Number of MAC Algorithms</i> e.g. <code>127 % 2 = 1</code>.<br>
						<b>MAC Algorithm</b> &#8592; <i>MAC Algorithms</i> [ <i>MAC Algorithm Index</i> ] e.g. <code>MAC Algorithms[1] = Keccak-512</code><br>
						<b>MAC Tag</b> &#8592; <i>MAC Algorithm</i>( <i>Key</i> || <i>Ciphertext</i> )<br>
						<b>Encrypted MAC Tag</b> &#8592; MAC Encryption Key &oplus; MAC Tag
					</div>
					<ul>						
						<li>
							For each message sent, a random MAC algorithm from a pool of algorithms is chosen to authenticate the 
							message. This provides some protection in the case that a fundamental flaw is discovered in one of the 
							hash algorithms in the future. It also makes message forgery more difficult as an attacker now only 
							has a 0.5 probability to guess the correct hash algorithm that was used to authenticate each message. 
							Currently there are only 2 hash algorithms that are used with the program due to the lack of current 
							library support. Currently the hash functions used are the 512 bit versions of 
							Keccak and Skein. These 512 bit MACs will provide 2<sup>256</sup> collision resistance and 
							2<sup>512</sup> pre-image resistance against regular computers. They  
							<a href="#ref196">will provide 2<sup>170</sup> collision resistance<sup>[196]</sup></a> and 2<sup>256</sup> 
							pre-image resistance against quantum computers.
						</li>
						<li>
							The program first gets a random index number from an array of available algorithms, then 
							it uses this algorithm to create the MAC. It selects the random array index by using the last byte of 
							the one-time pad. It converts this byte to an integer value (0 - 255), then uses that number modulo 
							the number of MAC algorithms available. Because there are only two MAC algorithms at the moment, that 
							will return an integer of 0 or 1 which references the index of the algorithm in an array. For all 
							possible bytes from 0 - 255 this provides an even distribution of 0 - 1 outputs.
						</li>
						<li>
							The process is to perform the encryption on the message parts first, then calculate the MAC from the 
							ciphertext and use the one-time pad as the key. This provides integrity of the ciphertext and integrity 
							of the plaintext. Also it does not provide any information on the plaintext since no structure from 
							the plaintext has been carried into the MAC. Skein and Keccak are newer, more secure hash algorithms 
							and do not need more complicated constructions like HMAC to prevent length extension attacks unlike 
							hash functions based on the the <a href="#ref198">Merkle–Damgård construction<sup>[198]</sup></a>. 
							The MAC can be created simply by 
							<a href="#ref199">prepending the message with the key and hashing it<sup>[199]</sup></a><a href="#ref200"><sup>[200]</sup></a>, 
							i.e. <span class="formulas"><i>H</i>( <i>K</i> || <i>M</i> )</span>.
						</li>
						<li>
							Finally the MAC tag is encrypted with the last 64 bytes (512 bits) of the one-time pad. This 
							retains the <a href="#ref25">information-theoretically secure<sup>[25]</sup></a> 
							properties for the MAC tag as well as the message. No attacker can know if they have successfully 
							deciphered the encryption by brute forcing combinations of the key to create a valid MAC tag. Nor can 
							an attacker know if they have created a successful forgery when they do not know the correct key.
						</li>
					</ul>
					
					
					<h2 id="failsafe-csprng"><span>21</span> Failsafe CSPRNG</h2>
					<p>
						For some functions of the program, general random bits or random numbers are needed. For these 
						functions it is not critical to have true randomness so a strong 
						<a href="#ref123">CSPRNG<sup>[123]</sup></a> will suffice:
					</p>
					<ul>						
						<li>Padding messages with random bits up to the maximum message length.</li>
						<li>Generating random numbers in order to send decoy messages at random intervals.</li>
						<li>Generating random 512 bit nonces for each server request.</li>
					</ul>
					<p>
						Most browsers now support the HTML5 Web Crypto API 
						<a href="#ref69">getRandomValues() function<sup>[69]</sup></a> which uses 
						the operating system's cryptographically secure random source (e.g. <code>/dev/urandom</code> on 
						Linux). The Web Crypto API could however be compromised by running a closed source operating 
						system (e.g. Windows or MacOS) &ndash; in which case Microsoft or Apple could have been 
						<a href="#ref68">paid off by the NSA<sup>[68]</sup></a> to make it use the 
						<a href="#ref13">Dual EC DRBG<sup>[13]</sup></a> by default as far as anyone in the public knows.
						
						Or it could also be compromised by a faulty browser implementation. Or it could also be 
						compromised by the underlying operating system's implementation such as it uses 
						<a href="#ref67">Intel's questionable on-chip RNG<sup>[67]</sup></a> (RDRAND).
						
						No-one really has time to continually review the various browser implementations of the Web 
						Crypto API or the various operating system implementations of their RNGs to make sure they are 
						secure. So if the browser's implementation of this CSPRNG is compromised then a failsafe RNG has 
						been devised.
					</p>
					<p>
						The program will use a 256 bit key, to create a keystream of random bits using the failsafe 
						CSPRNG Salsa20. This keystream is then XORed with the random bits returned from the Web Crypto 
						API.
						
						A unique 256 bit key is generated for each user by the TRNG and exported with the user's 
						one-time pads upon pad creation. When they load the one-time pads, this key is also loaded into 
						memory.
						
						The program will start the nonce at <code>0</code>, and increment by <code>1</code> after every 
						request for random bits. The nonce value is persisted in the local database storage so a nonce 
						is never re-used even if the program is restarted. The nonce can be safely incremented to 
						<code>2<sup>53</sup> - 1</code> (the <a href="#ref201">maximum safe integer<sup>[201]</sup></a> 
						in JavaScript) without failure, but this is very unlikely to ever be reached under normal use.
					</p>
					
					
					<h2 id="auto-nuke-process"><span>22</span> Self destruct process</h2>
					<p>
						The protocol normally erases the one-time pad as soon as a message is sent. The one-time pad is 
						also removed from a receiver's database after they have successfully received and authenticated 
						a message. This is a more secure form of off the record chat similar to the 
						<a href="#ref202">OTR messaging protocol<sup>[202]</sup></a>. 
						OTR has good principles but lacks the <a href="#ref25">perfect secrecy<sup>[25]</sup></a>  
						and <a href="#ref34">plausible deniability<sup>[34]</sup></a> of the one-time pad.
					</p>
					<p>
						One of the key features of the program is being able to trigger a 
						<a href="#ref204">duress code<sup>[204]</sup></a> which instantly and automatically wipe the local 
						database of one-time pads, the other users' local databases of one-time pads and clear any messages 
						remaining on screen.
					</p>
					<p>
						This should be initiated in an emergency situation only. Potentially if a chat group user believes their 
						database of one-time pads may be compromised soon, or 
						<a href="#ref203">Three Letter Agencies<sup>[203]</sup></a> are inbound on a 
						<a href="#ref80">helicopter assault<sup>[80]</sup></a> then they 
						should initiate the self destruct. This means that all the users are no longer in possession of 
						the decryption keys so it means they cannot be compelled to produce them under duress or in a 
						court of law. No encryption keys means no way to decrypt past messages. Without the real encryption 
						keys, a user under duress can easily think of any plausible plaintext message for any encrypted message and 
						an aggressor will not know the difference. A simple way to calculate this for a one-time pad, given any 
						ciphertext is to simply create a fake message, convert the ciphertext and fake message to binary, 
						then XOR them together which will produce a plausible key to give to an attacker.
					</p>
					
					
					<h2 id="extra-security-considerations"><span>23</span> Extra security considerations</h2>
					<p>
						There are a number of potential attacks which are more around 
						<a href="#ref205">social engineering<sup>[205]</sup></a>, side channel attacks, 
						retrieving the one-time pads by other means and attacks on the server. There are ways to 
						mitigate these issues as well.
					</p>
					<ul>
						<li>
							Keyloggers, trojans or spyware on the PC could compromise the one-time pads or chat messages. 
							To mitigate this, the one-time pads should be generated on a clean install of an 
							open source Operating System and a clean browser install. 
							Running different virtual machines for different programs like 
							<a href="#ref50">Qubes OS<sup>[50]</sup></a> 
							to isolate any potentially malicious programs could be effective. A clean browser install 
							means removing all the inbuilt proprietary extensions like Java and Flash. When creating the 
							one-time pads, the PC should be physically unplugged from any network and any 
							wireless/bluetooth adaptors should be disabled. The pads should be saved to removable media 
							such as MicroSD card, SD card or USB drive. The Operating System should be secure wiped from 
							the hard drive after completion. Booting into a 
							<a href="#ref206">Linux Live CD<sup>[206]</sup></a> would be useful for this. For running 
							the chat program, ideally the OS should be open source e.g. Linux and the browser 
							software compiled from source code. Firewalls, antivirus and antispyware tools must be 
							installed and activated. Shared computers in a library or cafe should not be used.
						</li>
						<li>
							An attacker could steal/copy the one-time pads as they are being delivered to the other person. 
							The encrypted one-time pad database should be kept on a small MicroSD card, SD card or USB 
							drive with the person at all times. Securing it in a zipped up pocket can prevent pickpockets. 
							If plausible deniability is needed, the one-time pads should be stored inside an encrypted 
							hidden volume with Truecrypt or other software. If the one-time pads have been misplaced they 
							have not been in the user's possession for a certain amount of time, they must be assumed to be 
							compromised and fresh ones must be created. Once loaded into each device, the encrypted text 
							file containing the one-time pads from the removable media should be erased. This leaves only 
							one copy of the pads which is being used by the software. The software will automatically 
							remove one-time pads as a message is received or sent.
						</li>
						<li>
							The server could be attacked or communications interfered with. Encrypted messages stay on 
							the server for a short period of time until the other chat participants retrieve them from 
							the server which is similar to email. However the requests to the server are frequent enough 
							that if both users are connected at the same time then it behaves as real-time chat. There 
							is potential for a nation state attacker to block communications and interfere with the 
							transmission of encrypted messages. They will not be able to decrypt any of the messages, 
							nor will they be able to forge or alter a message without detection due to the strong MAC. 
							However they could block messages being received, or hack into the server and delete messages 
							from the server, or perform a DOS type attack on communications.
							
							If an attacker like the NSA has already targeted the server 
							there is not much that can be done about it. The best option may be to set up a new server 
							somewhere else that they do not know about and inform chat participants of the new server 
							address. In the meantime the standard precautions for server installs should be used e.g. 
							setting up a firewall, blocking all ports except for port 80 which will be used by the 
							clients to connect to the server and port 22 for <a href="#ref208">SSH<sup>[208]</sup></a> 
							so the administer can still log in to the server. Changing the SSH port to a non-standard 
							port and using public key authentication could also be a consideration.
						</li>
						<li>
							Users will not be completely anonymous when communicating with the server. Potentially a 
							government may intercept the highly encrypted communications going from their IP address to 
							the server, and also from the server to the other user's IP. They may be suspicious at being 
							unable to decrypt the messages and try tracing the IP back to its source so they can arrest 
							the user for suspected terrorism. If everyone was using the program it would be considered 
							normal communications so they would be less likely to target a particular individual. Users 
							that are concerned about this could use a VPN or 
							<a href="#ref209">SOCKS proxy<sup>[209]</sup></a> with their browser to tunnel 
							their connections through a server in a different country. For added protection they could 
							always have chat conversations in a public place, e.g. cafe, library, WiFi hotspot or buy a 
							cheap pre-pay smartphone which will allow them to tether the Internet connection to their 
							laptop. 
							If using a mobile phone, it would be important to go somewhere different each time and then 
							connect to the cellular network. Also the GPS on the phone should be disabled so it is 
							harder to triangulate their position. For complete security the main battery should be 
							physically removed when done and a Faraday bag used to block any remote activation attempts  
							<a href="#ref210">even while it is turned off<sup>[210]</sup></a>. 
							The program does not currently work with the <a href="#ref211">Tor Browser Bundle<sup>[211]</sup></a> 
							because they block access to the local disk, so that rules out HTML5 Local Storage use. However 
							it is possible to configure the Tor application manually and use that as a SOCKS5 proxy with 
							a newer version of Firefox. It may even be possible to configure 
							<a href="#ref212">Tails OS<sup>[212]</sup></a> to load a Firefox 
							profile from a writable USB drive which could store and update the one-time pad database.
						</li>
						<li>
							Users could be forced to hand over their one-time pads with 
							<a href="#ref213">rubber-hose cryptanalysis<sup>[213]</sup></a> or 
							<a href="#ref214">beaten with a wrench<sup>[214]</sup></a>. While quite unlikely it could be 
							possible in some countries.
							The software makes sure that after a message is sent, the one-time pad is deleted from the device. 
							Then when the other user retrieves the message from the server, the encrypted message is deleted from 
							the server. Also when it has been decrypted on the other user's device, it is deleted from their local 
							database as well. This leaves no way to decrypt past messages. It also gives the user plausible 
							deniability that they can decrypt past messages again or remember exactly what was said. To 
							clear messages from the screen one simply needs to refresh the page using the F5 key on their 
							keyboard. To clear everything in an emergency, the self destruct should be initiated. This 
							option is available from the main menu. It will delete the one-time pads from all connected 
							devices. It will also clear sent messages on the screen of each device. This should be reserved 
							for an actual emergency because it is time consuming to recreate and deliver new one-time pads.
						</li>
					</ul>
					
					
					<h2 id="references"><span>23</span> References</h2>
					<ul class="references">
						<li id="ref1">
							1. Wikipedia - Global surveillance disclosures<br>
							<a href="https://en.wikipedia.org/wiki/Global_surveillance_disclosures_(2013-present)">https://en.wikipedia.org/wiki/Global_surveillance_disclosures_(2013-present)</a>
						</li>
						<li id="ref2">
							2. Wikipedia - National Security Agency<br>
							<a href="https://en.wikipedia.org/wiki/Nsa">https://en.wikipedia.org/wiki/Nsa</a>
						</li>
						<li id="ref3">
							3. The Guardian - Revealed: how US and UK spy agencies defeat Internet privacy and security<br>
							<a href="http://www.theguardian.com/world/2013/sep/05/nsa-gchq-encryption-codes-security">http://www.theguardian.com/world/2013/sep/05/nsa-gchq-encryption-codes-security</a>
						</li>
						<li id="ref4">
							4. Wired - The NSA Is Building the Country's Biggest Spy Center<br>
							<a href="http://www.wired.com/threatlevel/2012/03/ff_nsadatacenter/">http://www.wired.com/threatlevel/2012/03/ff_nsadatacenter/</a>
						</li>
						<li id="ref5">
							5. Wikipedia - Five Eyes - Future enlargement<br>
							<a href="https://en.wikipedia.org/wiki/Five_Eyes#Future_enlargement">https://en.wikipedia.org/wiki/Five_Eyes#Future_enlargement</a>
						</li>
						<li id="ref6">
							6. Norddeutscher Rundfunk - Snowden-Interview: Transcript<br>
							<a href="https://www.ndr.de/nachrichten/netzwelt/snowden277_page-2.html">https://www.ndr.de/nachrichten/netzwelt/snowden277_page-2.html</a>
						</li>
						<li id="ref7">
							7. United Nations - Universal Declaration of Human Rights<br>
							<a href="http://www.un.org/en/documents/udhr/">http://www.un.org/en/documents/udhr/</a>
						</li>
						<li id="ref8">
							8. Der Spiegel - Prying Eyes: Inside the NSA's War on Internet Security<br>
							<a href="http://www.spiegel.de/international/germany/inside-the-nsa-s-war-on-internet-security-a-1010361.html">http://www.spiegel.de/international/germany/inside-the-nsa-s-war-on-internet-security-a-1010361.html</a>
						</li>
						<li id="ref9">
							9. Der Spiegel - Shopping for Spy Gear: Catalog Advertises NSA Toolbox<br>
							<a href="http://www.spiegel.de/international/world/catalog-reveals-nsa-has-back-doors-for-numerous-devices-a-940994.html">http://www.spiegel.de/international/world/catalog-reveals-nsa-has-back-doors-for-numerous-devices-a-940994.html</a>
						</li>
						<li id="ref10">
							10. The Intercept - Exceptionally Compartmented Information<br>
							<a href="https://theintercept.com/2014/10/10/core-secrets/">https://theintercept.com/2014/10/10/core-secrets/</a>
						</li>
						<li id="ref11">
							11. Wikipedia - Enigma machine - Surviving machines<br>
							<a href="https://en.wikipedia.org/wiki/Enigma_machine#Breaking_Enigma">https://en.wikipedia.org/wiki/Enigma_machine#Breaking_Enigma</a>
						</li>
						<li id="ref12">
							12. The Guardian - Edward Snowden: NSA whistleblower answers reader questions<br>
							<a href="http://www.theguardian.com/world/2013/jun/17/edward-snowden-nsa-files-whistleblower">http://www.theguardian.com/world/2013/jun/17/edward-snowden-nsa-files-whistleblower</a>
						</li>
						<li id="ref13">
							13. A Few Thoughts on Cryptographic Engineering - The Many Flaws of Dual_EC_DRBG<br>
							<a href="http://blog.cryptographyengineering.com/2013/09/the-many-flaws-of-dualecdrbg.html">http://blog.cryptographyengineering.com/2013/09/the-many-flaws-of-dualecdrbg.html</a>
						</li>
						<li id="ref14">
							14. SafeCurves - Choosing safe curves for elliptic-curve cryptography<br>
							<a href="http://safecurves.cr.yp.to">http://safecurves.cr.yp.to</a>
						</li>
						<li id="ref15">
							15. Wikipedia - National Institute of Standards and Technology - Controversy<br>
							<a href="https://en.wikipedia.org/wiki/National_Institute_of_Standards_and_Technology#Controversy">https://en.wikipedia.org/wiki/National_Institute_of_Standards_and_Technology#Controversy</a>
						</li>
						<li id="ref16">
							16. Ars Technica - NSA employee will continue to co-chair influential crypto standards group<br>
							<a href="http://arstechnica.com/security/2014/01/nsa-employee-will-continue-to-co-chair-influential-crypto-standards-group/">http://arstechnica.com/security/2014/01/nsa-employee-will-continue-to-co-chair-influential-crypto-standards-group/</a>
						</li>
						<li id="ref17">
							17. A Few Thoughts on Cryptographic Engineering - Multiple encryption<br>
							<a href="http://blog.cryptographyengineering.com/2012/02/multiple-encryption.html">http://blog.cryptographyengineering.com/2012/02/multiple-encryption.html</a>
						</li>
						<li id="ref18">
							18. Der Spiegel - Prying Eyes: Inside the NSA's War on Internet Security - TUNDRA<br>
							<a href="http://www.spiegel.de/international/germany/bild-1010361-793640.html">http://www.spiegel.de/international/germany/bild-1010361-793640.html</a>
						</li>
						<li id="ref19">
							19. Wikipedia - Daniel J. Bernstein<br>
							<a href="https://en.wikipedia.org/wiki/Daniel_J._Bernstein">https://en.wikipedia.org/wiki/Daniel_J._Bernstein</a>
						</li>
						<li id="ref20">
							20. Wikipedia - Bruce Schneier<br>
							<a href="https://en.wikipedia.org/wiki/Bruce_Schneier">https://en.wikipedia.org/wiki/Bruce_Schneier</a>
						</li>
						<li id="ref21">
							21. Attacking and defending the McEliece cryptosystem - Daniel J. Bernstein, Tanja Lange and Christiane Peters<br>
							<a href="http://cr.yp.to/codes/mceliece-20080807.pdf">http://cr.yp.to/codes/mceliece-20080807.pdf</a>
						</li>
						<li id="ref22">
							22. Wikipedia - Hardware random number generator<br>
							<a href="https://en.wikipedia.org/wiki/Hardware_random_number_generator">https://en.wikipedia.org/wiki/Hardware_random_number_generator</a>
						</li>
						<li id="ref23">
							23. Wikipedia - One-time pad<br>
							<a href="https://en.wikipedia.org/wiki/One-time_pad">https://en.wikipedia.org/wiki/One-time_pad</a>
						</li>
						<li id="ref24">
							24. Wikipedia - Message authentication code<br>
							<a href="https://en.wikipedia.org/wiki/Message_authentication_code">https://en.wikipedia.org/wiki/Message_authentication_code</a>
						</li>
						<li id="ref25">
							25. Wikipedia - Information-theoretic security<br>
							<a href="https://en.wikipedia.org/wiki/Information-theoretic_security">https://en.wikipedia.org/wiki/Information-theoretic_security</a>
						</li>
						<li id="ref26">
							26. Wikipedia - One-time pad - Key distribution<br>
							<a href="https://en.wikipedia.org/wiki/One-time_pad#Key_distribution">https://en.wikipedia.org/wiki/One-time_pad#Key_distribution</a>
						</li>
						<li id="ref27">
							27. Wikipedia - Passphrase<br>
							<a href="https://en.wikipedia.org/wiki/Passphrase">https://en.wikipedia.org/wiki/Passphrase</a>
						</li>						
						<li id="ref28">
							28. Wikipedia - Key derivation function<br>
							<a href="https://en.wikipedia.org/wiki/Key_derivation_function">https://en.wikipedia.org/wiki/Key_derivation_function</a>
						</li>
						<li id="ref29">
							29. Wikipedia - Stream cipher<br>
							<a href="https://en.wikipedia.org/wiki/Stream_cipher">https://en.wikipedia.org/wiki/Stream_cipher</a>
						</li>
						<li id="ref30">
							30. Crypto Museum - Washington-Moscow Hotline - 1963: Teleprinter link<br>
							<a href="http://www.cryptomuseum.com/crypto/hotline/">http://www.cryptomuseum.com/crypto/hotline/</a>
						</li>
						<li id="ref31">
							31. Jericho Comms - Main website download page<br>
							<a href="https://joshua-m-david.github.io/jerichoencryption/download.html">https://joshua-m-david.github.io/jerichoencryption/</a>
						</li>
						<li id="ref32">
							32. GitHub - Jericho Comms source code repository<br>
							<a href="https://github.com/joshua-m-david/jerichoencryption/">https://github.com/joshua-m-david/jerichoencryption/</a>
						</li>
						<li id="ref33">
							33. Free Software Foundation - GNU General Public License<br>
							<a href="https://www.gnu.org/licenses/gpl-3.0.en.html">https://www.gnu.org/licenses/gpl-3.0.en.html</a>
						</li>
						<li id="ref34">
							34. Wikipedia - Plausible deniability<br>
							<a href="https://en.wikipedia.org/wiki/Plausible_deniability">https://en.wikipedia.org/wiki/Plausible_deniability</a>
						</li>
						<li id="ref35">
							35. Wikipedia - Shor's algorithm<br>
							<a href="https://en.wikipedia.org/wiki/Shor's_algorithm">https://en.wikipedia.org/wiki/Shor's_algorithm</a>
						</li>
						<li id="ref36">
							36. Washington Post - NSA seeks to build quantum computer that could crack most types of encryption<br>
							<a href="http://www.washingtonpost.com/world/national-security/nsa-seeks-to-build-quantum-computer-that-could-crack-most-types-of-encryption/2014/01/02/8fff297e-7195-11e3-8def-a33011492df2_story.html">http://www.washingtonpost.com/world/national-security/nsa-seeks-to-build-quantum-computer-that-could-crack-most-types-of-encryption/2014/01/02/8fff297e-7195-11e3-8def-a33011492df2_story.html</a>
						</li>
						<li id="ref37">
							37. Washington Post - The 'Black Budget' - How intelligence agencies spend $52 billion<br>
							<a href="http://www.washingtonpost.com/wp-srv/special/national/black-budget/project-files/black-budget-doubletruck-web.pdf">http://www.washingtonpost.com/wp-srv/special/national/black-budget/project-files/black-budget-doubletruck-web.pdf</a>
						</li>
						<li id="ref38">
							38. National Security Agency - Cryptography Today<br>
							<a href="https://www.nsa.gov/ia/programs/suiteb_cryptography/">https://www.nsa.gov/ia/programs/suiteb_cryptography/</a>
						</li>
						<li id="ref39">
							39. A Few Thoughts on Cryptographic Engineering - A riddle wrapped in a curve<br>
							<a href="http://blog.cryptographyengineering.com/2015/10/a-riddle-wrapped-in-curve.html">http://blog.cryptographyengineering.com/2015/10/a-riddle-wrapped-in-curve.html</a>
						</li>
						<li id="ref40">
							40. International Association for Cryptologic Research - Neal Koblitz and Alfred J. Menezes - A Riddle Wrapped in an Enigma<br>
							<a href="http://eprint.iacr.org/2015/1018.pdf">http://eprint.iacr.org/2015/1018.pdf</a>
						</li>
						<li id="ref41">
							41. Wikipedia - McEliece cryptosystem<br>
							<a href="https://en.wikipedia.org/wiki/McEliece_cryptosystem">https://en.wikipedia.org/wiki/McEliece_cryptosystem</a>
						</li>
						<li id="ref42">
							42. Biometric Update - UAB researchers find that automated voice imitation can spoof voice authentication systems<br>
							<a href="http://www.biometricupdate.com/201509/uab-researchers-find-that-automated-voice-imitation-can-spoof-voice-authentication-systems">http://www.biometricupdate.com/201509/uab-researchers-find-that-automated-voice-imitation-can-spoof-voice-authentication-systems</a>
						</li>
						<li id="ref43">
							43. Schneier on Security - How the NSA Attacks Tor/Firefox Users With QUANTUM and FOXACID<br>
							<a href="https://www.schneier.com/blog/archives/2013/10/how_the_nsa_att.html">https://www.schneier.com/blog/archives/2013/10/how_the_nsa_att.html</a>
						</li>
						<li id="ref44">
							44. Wikipedia - Man-in-the-middle attack<br>
							<a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">https://en.wikipedia.org/wiki/Man-in-the-middle_attack</a>
						</li>
						<li id="ref45">
							45. Moxie Marlinspike - SSL And The Future Of Authenticity<br>
							<a href="http://www.thoughtcrime.org/blog/ssl-and-the-future-of-authenticity/">http://www.thoughtcrime.org/blog/ssl-and-the-future-of-authenticity/</a>
						</li>
						<li id="ref46">
							46. StackExchange - Information Security - Are self-signed certificates actually more secure than CA signed certificates now?<br>
							<a href="http://security.stackexchange.com/questions/42409/are-self-signed-certificates-actually-more-secure-than-ca-signed-certificates-no">http://security.stackexchange.com/questions/42409/are-self-signed-certificates-actually-more-secure-than-ca-signed-certificates-no</a>
						</li>						
						<li id="ref47">
							47. Cossack Labs - Why you should avoid SSL for your next application<br>
							<a href="https://www.cossacklabs.com/avoid-ssl-for-your-next-app.html">https://www.cossacklabs.com/avoid-ssl-for-your-next-app.html</a>
						</li>
						<li id="ref48">
							48. Wikipedia - Exclusive or<br>
							<a href="https://en.wikipedia.org/wiki/Exclusive_disjunction">https://en.wikipedia.org/wiki/Exclusive_disjunction</a>
						</li>
						<li id="ref49">
							49. Wikipedia - Star network<br>
							<a href="https://en.wikipedia.org/wiki/Star_network">https://en.wikipedia.org/wiki/Star_network</a>
						</li>
						<li id="ref50">
							50. Qubes OS Project<br>
							<a href="https://www.qubes-os.org">https://www.qubes-os.org</a>
						</li>
						<li id="ref51">
							51. Electronic Frontier Foundation - EFF v. NSA, ODNI - Vulnerabilities FOIA<br>
							<a href="https://www.eff.org/cases/eff-v-nsa-odni-vulnerabilities-foia">https://www.eff.org/cases/eff-v-nsa-odni-vulnerabilities-foia</a>
						</li>
						<li id="ref52">
							52. Wikipedia - Venona project - Decryption<br>
							<a href="http://en.wikipedia.org/wiki/VENONA_project#Decryption">http://en.wikipedia.org/wiki/VENONA_project#Decryption</a>
						</li>
						<li id="ref53">
							53. Open Crypto Audit Project - Verified TrueCrypt v. 7.1 source and binary mirror<br>
							<a href="https://opencryptoaudit.org">https://opencryptoaudit.org</a>
						</li>
						<li id="ref54">
							54. Wikipedia - Secure channel<br>
							<a href="https://en.wikipedia.org/wiki/Secure_channel">https://en.wikipedia.org/wiki/Secure_channel</a>
						</li>
						<li id="ref55">
							55. Wikipedia - Air gap (networking)<br>
							<a href="https://en.wikipedia.org/wiki/Air_gap_(networking)">https://en.wikipedia.org/wiki/Air_gap_(networking)</a>
						</li>
						<li id="ref56">
							56. Wikipedia - Dead drop<br>
							<a href="http://en.wikipedia.org/wiki/Dead_drop">http://en.wikipedia.org/wiki/Dead_drop</a>
						</li>
						<li id="ref57">
							57. Wikipedia - Customs<br>
							<a href="https://en.wikipedia.org/wiki/Customs">https://en.wikipedia.org/wiki/Customs</a>
						</li>
						<li id="ref58">
							58. Wikipedia - Modulo operator<br>
							<a href="https://en.wikipedia.org/wiki/Modulo_operation">https://en.wikipedia.org/wiki/Modulo_operation</a>
						</li>
						<li id="ref59">
							59. Wikipedia - Steganography<br>
							<a href="https://en.wikipedia.org/wiki/Steganography">https://en.wikipedia.org/wiki/Steganography</a>
						</li>
						<li id="ref60">
							60. Wikipedia - Diplomatic bag<br>
							<a href="https://en.wikipedia.org/wiki/Diplomatic_bag">https://en.wikipedia.org/wiki/Diplomatic_bag</a>
						</li>
						<li id="ref61">
							61. Wikipedia - Vienna Convention on Diplomatic Relations - Summary of provisions - Article 27<br>
							<a href="https://en.wikipedia.org/wiki/Vienna_Convention_on_Diplomatic_Relations#Summary_of_provisions">https://en.wikipedia.org/wiki/Vienna_Convention_on_Diplomatic_Relations#Summary_of_provisions</a>
						</li>
						<li id="ref62">
							62. Wikipedia - One-time pad - Perfect secrecy<br>
							<a href="https://en.wikipedia.org/wiki/One-time_pad#Perfect_secrecy">https://en.wikipedia.org/wiki/One-time_pad#Perfect_secrecy</a>
						</li>
						<li id="ref63">
							63. Wikipedia - Tamper-evident technology<br>
							<a href="https://en.wikipedia.org/wiki/Tamper-evident_technology">https://en.wikipedia.org/wiki/Tamper-evident_technology</a>
						</li>
						<li id="ref64">
							64. Wikipedia - SIGSALY<br>
							<a href="https://en.wikipedia.org/wiki/SIGSALY">https://en.wikipedia.org/wiki/SIGSALY</a>
						</li>
						<li id="ref65">
							65. Wikipedia - Traffic analysis<br>
							<a href="https://en.wikipedia.org/wiki/Traffic_analysis">https://en.wikipedia.org/wiki/Traffic_analysis</a>
						</li>
						<li id="ref66">
							66. Veracrypt - Technical Details - Keyfiles<br>
							<a href="http://www.veracrypt.fr/en/docs/keyfiles-technical-details/">http://www.veracrypt.fr/en/docs/keyfiles-technical-details/</a>
						</li>
						<li id="ref67">
							67. StackExchange - Cryptography - Could RDRAND (Intel) compromise entropy?<br>
							<a href="http://crypto.stackexchange.com/questions/10283/could-rdrand-intel-compromise-entropy">http://crypto.stackexchange.com/questions/10283/could-rdrand-intel-compromise-entropy</a>
						</li>
						<li id="ref68">
							68. ArsTechnica - Report: NSA paid RSA to make flawed crypto algorithm the default<br>
							<a href="http://arstechnica.com/security/2013/12/report-nsa-paid-rsa-to-make-flawed-crypto-algorithm-the-default/">http://arstechnica.com/security/2013/12/report-nsa-paid-rsa-to-make-flawed-crypto-algorithm-the-default/</a>
						</li>
						<li id="ref69">
							69. World Wide Web Consortium (W3C) - Web Cryptography API - 10.2.1. The getRandomValues method<br>
							<a href="http://www.w3.org/TR/WebCryptoAPI/#Crypto-method-getRandomValues">http://www.w3.org/TR/WebCryptoAPI/#Crypto-method-getRandomValues</a>
						</li>
						<li id="ref70">
							70. Wikipedia - /dev/random<br>
							<a href="https://en.wikipedia.org/wiki//dev/random">https://en.wikipedia.org/wiki//dev/random</a>
						</li>
						<li id="ref71">
							71. Wikipedia - Shot noise<br>
							<a href="https://en.wikipedia.org/wiki/Shot_noise">https://en.wikipedia.org/wiki/Shot_noise</a>
						</li>
						<li id="ref72">
							72. Wikipedia - Least significant bit<br>
							<a href="https://en.wikipedia.org/wiki/Least_significant_bit">https://en.wikipedia.org/wiki/Least_significant_bit</a>
						</li>
						<li id="ref73">
							73. Wikipedia - Macro photography<br>
							<a href="https://en.wikipedia.org/wiki/Macro_photography">https://en.wikipedia.org/wiki/Macro_photography</a>
						</li>
						<li id="ref74">
							74. Wikipedia - Raw image format<br>
							<a href="https://en.wikipedia.org/wiki/Raw_image_format">https://en.wikipedia.org/wiki/Raw_image_format</a>
						</li>
						<li id="ref75">
							75. Wikipedia - Portable Network Graphics<br>
							<a href="https://en.wikipedia.org/wiki/Portable_Network_Graphics">https://en.wikipedia.org/wiki/Portable_Network_Graphics</a>
						</li>
						<li id="ref76">
							76. Wikipedia - BMP file format<br>
							<a href="https://en.wikipedia.org/wiki/BMP_file_format">https://en.wikipedia.org/wiki/BMP_file_format</a>
						</li>
						<li id="ref77">
							77. Wikipedia - JPEG<br>
							<a href="https://en.wikipedia.org/wiki/JPEG">https://en.wikipedia.org/wiki/JPEG</a>
						</li>
						<li id="ref78">
							78. VeraCrypt / TrueCrypt - Portable Mode<br>
							<a href="https://veracrypt.codeplex.com/wikipage?title=Portable%20Mode">https://veracrypt.codeplex.com/wikipage?title=Portable%20Mode</a>
						</li>
						<li id="ref79">
							79. PortableApps.com - Mozilla Firefox, Portable Edition<br>
							<a href="http://portableapps.com/apps/internet/firefox_portable">http://portableapps.com/apps/internet/firefox_portable</a>
						</li>
						<li id="ref80">
							80. YouTube - Kim Dotcom raid video revealed<br>
							<a href="https://www.youtube.com/watch?v=pMas0tWc0sg">https://www.youtube.com/watch?v=pMas0tWc0sg</a>
						</li>
						<li id="ref81">
							81. Wikipedia - Tailored Access Operations<br>
							<a href="https://en.wikipedia.org/wiki/Tailored_Access_Operations">https://en.wikipedia.org/wiki/Tailored_Access_Operations</a>
						</li>
						<li id="ref82">
							82. The Guardian - Ladar Levison: Secrets, lies and Snowden's email: why I was forced to shut down Lavabit<br>
							<a href="http://www.theguardian.com/commentisfree/2014/may/20/why-did-lavabit-shut-down-snowden-email">http://www.theguardian.com/commentisfree/2014/may/20/why-did-lavabit-shut-down-snowden-email</a>
						</li>
						<li id="ref83">
							83. Wikipedia - Representational state transfer<br>
							<a href="https://en.wikipedia.org/wiki/Representational_state_transfer">https://en.wikipedia.org/wiki/Representational_state_transfer</a>
						</li>
						<li id="ref84">
							84. Wikipedia - Application programming interface<br>
							<a href="https://en.wikipedia.org/wiki/Application_programming_interface">https://en.wikipedia.org/wiki/Application_programming_interface</a>
						</li>
						<li id="ref85">
							85. Wikipedia - JSON<br>
							<a href="https://en.wikipedia.org/wiki/JSON">https://en.wikipedia.org/wiki/JSON</a>
						</li>
						<li id="ref86">
							86. Wikipedia - Apache HTTP Server<br>
							<a href="https://en.wikipedia.org/wiki/Apache_HTTP_Server">https://en.wikipedia.org/wiki/Apache_HTTP_Server</a>
						</li>
						<li id="ref87">
							87. Wikipedia - MySQL<br>
							<a href="https://en.wikipedia.org/wiki/MySQL">https://en.wikipedia.org/wiki/MySQL</a>
						</li>
						<li id="ref88">
							88. Wikipedia - PHP<br>
							<a href="https://en.wikipedia.org/wiki/PHP">https://en.wikipedia.org/wiki/PHP</a>
						</li>
						<li id="ref89">
							89. Wikipedia - Memory safety<br>
							<a href="https://en.wikipedia.org/wiki/Memory_safety">https://en.wikipedia.org/wiki/Memory_safety</a>
						</li>
						<li id="ref90">
							90. Wikipedia - LAMP (software bundle)<br>
							<a href="https://en.wikipedia.org/wiki/LAMP_(software_bundle)">https://en.wikipedia.org/wiki/LAMP_(software_bundle)</a>
						</li>
						<li id="ref91">
							91. Ubuntu - Server - Overview<br>
							<a href="http://www.ubuntu.com/server">http://www.ubuntu.com/server</a>
						</li>
						<li id="ref92">
							92. Jericho Comms - Server Installation Guide<br>
							<a href="https://joshua-m-david.github.io/jerichoencryption/installation-server.html">https://joshua-m-david.github.io/jerichoencryption/installation-server.html</a>
						</li>
						<li id="ref93">
							93. Wikipedia - Virtual private server<br>
							<a href="https://en.wikipedia.org/wiki/Virtual_private_server">https://en.wikipedia.org/wiki/Virtual_private_server</a>
						</li>
						<li id="ref94">
							94. Wikipedia - National security letter<br>
							<a href="https://en.wikipedia.org/wiki/National_security_letter">https://en.wikipedia.org/wiki/National_security_letter</a>
						</li>
						<li id="ref95">
							95. Moxie Marlinspike - SSL And The Future Of Authenticity<br>
							<a href="http://www.thoughtcrime.org/blog/ssl-and-the-future-of-authenticity/">http://www.thoughtcrime.org/blog/ssl-and-the-future-of-authenticity/</a>
						</li>
						<li id="ref96">
							96. Youtube - DEFCON 19 - Moxie Marlinspike - SSL And The Future Of Authenticity<br>
							<a href="https://www.youtube.com/watch?v=pDmj_xe7EIQ">https://www.youtube.com/watch?v=pDmj_xe7EIQ</a>
						</li>
						<li id="ref97">
							97. Wikipedia - Man-in-the-middle attack<br>
							<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">http://en.wikipedia.org/wiki/Man-in-the-middle_attack</a>
						</li>
						<li id="ref98">
							98. Wikipedia - Heartbleed<br>
							<a href="http://en.wikipedia.org/wiki/Heartbleed">http://en.wikipedia.org/wiki/Heartbleed</a>
						</li>
						<li id="ref99">
							99. ArsTechnica - Critical crypto bug leaves Linux, hundreds of apps open to eavesdropping<br>
							<a href="http://arstechnica.com/security/2014/03/critical-crypto-bug-leaves-linux-hundreds-of-apps-open-to-eavesdropping/">http://arstechnica.com/security/2014/03/critical-crypto-bug-leaves-linux-hundreds-of-apps-open-to-eavesdropping/</a>
						</li>
						<li id="ref100">
							100. ArsTechnica - Extremely critical crypto flaw in iOS may also affect fully patched Macs<br>
							<a href="http://arstechnica.com/security/2014/02/extremely-critical-crypto-flaw-in-ios-may-also-affect-fully-patched-macs/">http://arstechnica.com/security/2014/02/extremely-critical-crypto-flaw-in-ios-may-also-affect-fully-patched-macs/</a>
						</li>
						<li id="ref101">
							101. Wikipedia - Deniable authentication<br>
							<a href="https://en.wikipedia.org/wiki/Deniable_authentication">https://en.wikipedia.org/wiki/Deniable_authentication</a>
						</li>
						<li id="ref102">
							102. The Intercept - XKEYSCORE: NSA's Google for the World's Private Communications<br>
							<a href="https://theintercept.com/2015/07/01/nsas-google-worlds-private-communications/">https://theintercept.com/2015/07/01/nsas-google-worlds-private-communications/</a>
						</li>
						<li id="ref103">
							103. Der Spiegel - Inside TAO: Documents Reveal Top NSA Hacking Unit<br>
							<a href="http://www.spiegel.de/international/world/the-nsa-uses-powerful-toolbox-in-effort-to-spy-on-global-networks-a-940969-3.html">http://www.spiegel.de/international/world/the-nsa-uses-powerful-toolbox-in-effort-to-spy-on-global-networks-a-940969-3.html</a>
						</li>
						<li id="ref104">
							104. Wikipedia - NATO phonetic alphabet<br>
							<a href="https://en.wikipedia.org/wiki/NATO_phonetic_alphabet">https://en.wikipedia.org/wiki/NATO_phonetic_alphabet</a>
						</li>
						<li id="ref105">
							105. Wikipedia - Unix time<br>
							<a href="https://en.wikipedia.org/wiki/Unix_time">https://en.wikipedia.org/wiki/Unix_time</a>
						</li>
						<li id="ref106">
							106. Wikipedia - Cryptographic nonce<br>
							<a href="https://en.wikipedia.org/wiki/Cryptographic_nonce">https://en.wikipedia.org/wiki/Cryptographic_nonce</a>
						</li>
						<li id="ref107">
							107. Wikipedia - Assignment (computer science)<br>
							<a href="https://en.wikipedia.org/wiki/Assignment_(computer_science)">https://en.wikipedia.org/wiki/Assignment_(computer_science)</a>
						</li>
						<li id="ref108">
							108. Wikipedia - Concatenation<br>
							<a href="https://en.wikipedia.org/wiki/Concatenation">https://en.wikipedia.org/wiki/Concatenation</a>
						</li>
						<li id="ref109">
							109. Wikipedia - Skein (hash function)<br>
							<a href="https://en.wikipedia.org/wiki/Skein_(hash_function)">https://en.wikipedia.org/wiki/Skein_(hash_function)</a>
						</li>
						<li id="ref110">
							110. NCC Group - iSEC Partners - Blog - Double HMAC Verification<br>
							<a href="https://www.isecpartners.com/blog/2011/february/double-hmac-verification.aspx">https://www.isecpartners.com/blog/2011/february/double-hmac-verification.aspx</a>
						</li>
						<li id="ref111">
							111. StackOverflow - Does it matter which equals operator (== vs ===) I use in JavaScript comparisons?<br>
							<a href="http://stackoverflow.com/a/359509">http://stackoverflow.com/a/359509</a>
						</li>
						<li id="ref112">
							112. Wikipedia - Base64<br>
							<a href="https://en.wikipedia.org/wiki/Base64">https://en.wikipedia.org/wiki/Base64</a>
						</li>
						<li id="ref113">
							113. Wikipedia - Information leakage<br>
							<a href="https://en.wikipedia.org/wiki/Information_Leakage">https://en.wikipedia.org/wiki/Information_Leakage</a>
						</li>
						<li id="ref114">
							114. Wikipedia - Chaffing and Winnowing<br>
							<a href="https://en.wikipedia.org/wiki/Chaffing_and_winnowing">https://en.wikipedia.org/wiki/Chaffing_and_winnowing</a>
						</li>
						<li id="ref115">
							115. W3C - Web Cryptography API<br>
							<a href="http://www.w3.org/TR/WebCryptoAPI/">http://www.w3.org/TR/WebCryptoAPI/</a>
						</li>
						<li id="ref116">
							116. Wikipedia Grover's algorithm<br>
							<a href="https://en.wikipedia.org/wiki/Grover%27s_algorithm">https://en.wikipedia.org/wiki/Grover%27s_algorithm</a>
						</li>
						<li id="ref117">
							117. Jericho Comms - Server Installation Guide - Create and install a TLS certificate<br>
							<a href="https://joshua-m-david.github.io/jerichoencryption/installation-server-tls.html">https://joshua-m-david.github.io/jerichoencryption/installation-server-tls.html</a>
						</li>
						<li id="ref118">
							118. Wikipedia - SHA-3<br>
							<a href="https://en.wikipedia.org/wiki/SHA-3">https://en.wikipedia.org/wiki/SHA-3</a>
						</li>
						<li id="ref119">
							119. The Keccak sponge function family<br>
							<a href="http://keccak.noekeon.org/">http://keccak.noekeon.org/</a>
						</li>
						<li id="ref120">
							120. Wikipedia - NIST hash function competition<br>
							<a href="https://en.wikipedia.org/wiki/NIST_hash_function_competition">https://en.wikipedia.org/wiki/NIST_hash_function_competition</a>
						</li>
						<li id="ref121">
							121. Wikipedia - While loop<br>
							<a href="https://en.wikipedia.org/wiki/While_loop">https://en.wikipedia.org/wiki/While_loop</a>
						</li>
						<li id="ref122">
							122. Wikipedia - Pseudorandom number generator<br>
							<a href="http://en.wikipedia.org/wiki/Pseudo-random_number_generator">http://en.wikipedia.org/wiki/Pseudo-random_number_generator</a>
						</li>
						<li id="ref123">
							123. Wikipedia - Cryptographically secure pseudorandom number generator<br>
							<a href="https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator">https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator</a>
						</li>
						<li id="ref124">
							124. NIST - Federal Information Processing Standards (FIPS) Publication 140-2 - Section 4.9.1 - Power-Up Tests - Page 57 - 58<br>
							<a href="http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf">http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf</a>
						</li>
						<li id="ref125">
							125. Wikipedia - Bitmap<br>
							<a href="https://en.wikipedia.org/wiki/Bitmap">https://en.wikipedia.org/wiki/Bitmap</a>
						</li>
						<li id="ref126">
							126. RANDOM.ORG - Statistical Analysis - Simple Visual Analysis<br>
							<a href="https://www.random.org/analysis/">https://www.random.org/analysis/</a>
						</li>
						<li id="ref127">
							127. Wikipedia - Canon PowerShot G - G7 to G12<br>
							<a href="https://en.wikipedia.org/wiki/Canon_PowerShot_G#G7_to_G12">https://en.wikipedia.org/wiki/Canon_PowerShot_G#G7_to_G12</a>
						</li>
						<li id="ref128">
							128. Wikipedia - Raw image format<br>
							<a href="https://en.wikipedia.org/wiki/Raw_image_format">https://en.wikipedia.org/wiki/Raw_image_format</a>
						</li>
						<li id="ref129">
							129. MIUI - The second operating system hiding in every mobile phone<br>
							<a href="http://en.miui.com/thread-10712-1-1.html">http://en.miui.com/thread-10712-1-1.html</a>
						</li>
						<li id="ref130">
							130. Wikipedia - Air gap (networking)<br>
							<a href="https://en.wikipedia.org/wiki/Air_gap_(networking)">https://en.wikipedia.org/wiki/Air_gap_(networking)</a>
						</li>
						<li id="ref131">
							131. Peter Gutmann - Secure Deletion of Data from Magnetic and Solid-State Memory<br>
							<a href="http://www.cs.auckland.ac.nz/~pgut001/pubs/secure_del.html">http://www.cs.auckland.ac.nz/~pgut001/pubs/secure_del.html</a>
						</li>
						<li id="ref132">
							132. How To Geek - The HTG Guide to Hiding Your Data in a TrueCrypt Hidden Volume<br>
							<a href="http://www.howtogeek.com/109210/the-htg-guide-to-hiding-your-data-in-a-truecrypt-hidden-volume">http://www.howtogeek.com/109210/the-htg-guide-to-hiding-your-data-in-a-truecrypt-hidden-volume</a>
						</li>
						<li id="ref133">
							133. VeraCrypt - Documentation - Hidden Volume<br>
							<a href="https://veracrypt.codeplex.com/wikipage?title=Hidden%20Volume">https://veracrypt.codeplex.com/wikipage?title=Hidden%20Volume</a>
						</li>
						<li id="ref134">
							134. Wikipedia - Advanced Encryption Standard<br>
							<a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">https://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a>
						</li>						
						<li id="ref135">
							135. Wikipedia - Block cipher mode of operation - Counter (CTR)<br>
							<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_.28CTR.29">https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_.28CTR.29</a>
						</li>
						<li id="ref136">
							136. Wikipedia - Salsa20<br>
							<a href="https://en.wikipedia.org/wiki/Salsa20">https://en.wikipedia.org/wiki/Salsa20</a>
						</li>
						<li id="ref137">
							137. Wikipedia - Advanced Encryption Standard process<br>
							<a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard_process">https://en.wikipedia.org/wiki/Advanced_Encryption_Standard_process</a>
						</li>
						<li id="ref138">
							138. Wikipedia - eSTREAM - In ESTREAM portfolio<br>
							<a href="https://en.wikipedia.org/wiki/ESTREAM#In_ESTREAM_portfolio">https://en.wikipedia.org/wiki/ESTREAM#In_ESTREAM_portfolio</a>
						</li>
						<li id="ref139">
							139. Wikipedia - Cryptanalysis - Symmetric ciphers<br>
							<a href="https://en.wikipedia.org/wiki/Cryptanalysis#Symmetric_ciphers">https://en.wikipedia.org/wiki/Cryptanalysis#Symmetric_ciphers</a>
						</li>
						<li id="ref140">
							140. Wikipedia - Known-plaintext attack<br>
							<a href="https://en.wikipedia.org/wiki/Known-plaintext_attack">https://en.wikipedia.org/wiki/Known-plaintext_attack</a>
						</li>
						<li id="ref141">
							141. Wikipedia - Chosen-plaintext attack<br>
							<a href="https://en.wikipedia.org/wiki/Chosen-plaintext_attack">https://en.wikipedia.org/wiki/Chosen-plaintext_attack</a>
						</li>
						<li id="ref142">
							142. Wikipedia - Authenticated encryption - Encrypt-then-MAC (EtM)<br>
							<a href="https://en.wikipedia.org/wiki/Authenticated_encryption#Encrypt-then-MAC_.28EtM.29">https://en.wikipedia.org/wiki/Authenticated_encryption#Encrypt-then-MAC_.28EtM.29</a>
						</li>
						<li id="ref143">
							143. Hugo Krawczyk - The Order of Encryption and Authentication for Protecting Communications<br>
							<a href="https://www.iacr.org/archive/crypto2001/21390309.pdf">https://www.iacr.org/archive/crypto2001/21390309.pdf</a>
						</li>
						<li id="ref144">
							144. Wikipedia - SHA-3 - Instances<br>
							<a href="https://en.wikipedia.org/wiki/SHA-3#Instances">https://en.wikipedia.org/wiki/SHA-3#Instances</a>
						</li>
						<li id="ref145">
							145. Wikipedia - Key Wrap<br>
							<a href="https://en.wikipedia.org/wiki/Key_Wrap">https://en.wikipedia.org/wiki/Key_Wrap</a>
						</li>
						<li id="ref146">
							146. Wikipedia - PBKDF2<br>
							<a href="https://en.wikipedia.org/wiki/PBKDF2">https://en.wikipedia.org/wiki/PBKDF2</a>
						</li>
						<li id="ref147">
							147. StackExchange - Cryptography - How secure would HMAC-SHA3 be?<br>
							<a href="https://crypto.stackexchange.com/questions/15782/how-secure-would-hmac-sha3-be/15825#15825">https://crypto.stackexchange.com/questions/15782/how-secure-would-hmac-sha3-be/15825#15825</a>
						</li>
						<li id="ref148">
							148. Wikipedia - SHA-2<br>
							<a href="https://en.wikipedia.org/wiki/SHA-2">https://en.wikipedia.org/wiki/SHA-2</a>
						</li>
						<li id="ref149">
							149. Wikipedia - Data Encryption Standard - History of DES - NSA's involvement in the design<br>
							<a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard#NSA.27s_involvement_in_the_design">https://en.wikipedia.org/wiki/Data_Encryption_Standard#NSA.27s_involvement_in_the_design</a>
						</li>
						<li id="ref150">
							150. Application-specific integrated circuit<br>
							<a href="https://en.wikipedia.org/wiki/Application-specific_integrated_circuit">https://en.wikipedia.org/wiki/Application-specific_integrated_circuit</a>
						</li>
						<li id="ref151">
							151. Alex Biryukov, Daniel Dinu, and Dmitry Khovratovich - Argon2: the memory-hard function for password hashing and other applications<br>
							<a href="https://password-hashing.net/argon2-specs.pdf">https://password-hashing.net/argon2-specs.pdf</a>
						</li>
						<li id="ref152">
							152. Password Hashing Competition<br>
							<a href="https://password-hashing.net/">https://password-hashing.net/</a>
						</li>
						<li id="ref153">
							153. Wikipedia - bcrypt<br>
							<a href="https://en.wikipedia.org/wiki/Bcrypt">https://en.wikipedia.org/wiki/Bcrypt</a>
						</li>
						<li id="ref154">
							154. Wikipedia - scrypt<br>
							<a href="https://en.wikipedia.org/wiki/Scrypt">https://en.wikipedia.org/wiki/Scrypt</a>
						</li>
						<li id="ref155">
							155. The Skein Hash Function Family - Section 4.8 - Skein as a Password-Based Key Derivation Function (PBKDF)<br>
							<a href="https://www.schneier.com/skein1.3.pdf">https://www.schneier.com/skein1.3.pdf</a>
						</li>
						<li id="ref156">
							156. StackExchange - Cryptography - Security of KDF1 and KDF2 (hash based KDF's)<br>
							<a href="https://crypto.stackexchange.com/questions/15673/security-of-kdf1-and-kdf2-hash-based-kdfs">https://crypto.stackexchange.com/questions/15673/security-of-kdf1-and-kdf2-hash-based-kdfs</a>
						</li>
						<li id="ref157">
							157. Wikipedia - Length extension attack<br>
							<a href="https://en.wikipedia.org/wiki/Length_extension_attack">https://en.wikipedia.org/wiki/Length_extension_attack</a>
						</li>
						<li id="ref158">
							158. NCC Group - Thomas Ptacek - Javascript Cryptography Considered Harmful<br>
							<a href="https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2011/august/javascript-cryptography-considered-harmful/">https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2011/august/javascript-cryptography-considered-harmful/</a>
						</li>
						<li id="ref159">
							159. Meadhbh Hamrick - In Defense of JavaScript Cryptography<br>
							<a href="https://webcache.googleusercontent.com/search?q=cache:SJ4wtE3DMSUJ:blog.meadhbh.org/2013/08/in-defense-of-javascript-cryptography.html">https://webcache.googleusercontent.com/search?q=cache:SJ4wtE3DMSUJ:blog.meadhbh.org/2013/08/in-defense-of-javascript-cryptography.html</a>
						</li>
						<li id="ref160">
							160. Nadim Kobeissi - Thoughts on Matasano Security's Critique of Javascript Cryptography<br>
							<a href="https://archive.is/hLei0">https://archive.is/hLei0</a>
						</li>
						<li id="ref161">
							161. Jericho Comms - Frequently Asked Questions - What about Matasano Security's claims that JavaScript cryptography is insecure?<br>
							<a href="https://joshua-m-david.github.io/jerichoencryption/faq.html#matasano-article-discussion">https://joshua-m-david.github.io/jerichoencryption/faq.html#matasano-article-discussion</a>
						</li>
						<li id="ref162">
							162. Wikipedia - tar (computing) - Uses - Software distribution<br>
							<a href="https://en.wikipedia.org/wiki/Tar_(computing)#Software_distribution">https://en.wikipedia.org/wiki/Tar_(computing)#Software_distribution</a>
						</li>
						<li id="ref163">
							163. W3C - Web Storage<br>
							<a href="http://www.w3.org/TR/webstorage/">http://www.w3.org/TR/webstorage/</a>
						</li>
						<li id="ref164">
							164. W3C - The WebSocket API<br>
							<a href="http://www.w3.org/TR/websockets/">http://www.w3.org/TR/websockets/</a>
						</li>
						<li id="ref165">
							165. W3C - File API<br>
							<a href="http://www.w3.org/TR/FileAPI/">http://www.w3.org/TR/FileAPI/</a>
						</li>
						<li id="ref166">
							166. Firebug - JavaScript Debugger and Profiler<br>
							<a href="https://getfirebug.com/javascript">https://getfirebug.com/javascript</a>
						</li>
						<li id="ref167">
							167. Wikipedia - Firefox OS<br>
							<a href="https://en.wikipedia.org/wiki/Firefox_OS">https://en.wikipedia.org/wiki/Firefox_OS</a>
						</li>
						<li id="ref168">
							168. Mozilla - The Mozilla Manifesto<br>
							<a href="https://www.mozilla.org/en-US/about/manifesto/">https://www.mozilla.org/en-US/about/manifesto/</a>
						</li>
						<li id="ref169">
							169. Mozilla - Download Firefox<br>
							<a href="https://www.mozilla.org/en-US/firefox/">https://www.mozilla.org/en-US/firefox/</a>
						</li>
						<li id="ref170">
							170. The Chromium Projects - Chromium<br>
							<a href="https://www.chromium.org/Home">https://www.chromium.org/Home</a>
						</li>
						<li id="ref171">
							171. Wikipedia - PRISM (surveillance program)<br>
							<a href="https://en.wikipedia.org/wiki/PRISM_(surveillance_program)">https://en.wikipedia.org/wiki/PRISM_(surveillance_program)</a>
						</li>
						<li id="ref172">
							172. Ars Technica - Not OK, Google: Chromium voice extension pulled after spying concerns<br>
							<a href="http://arstechnica.com/security/2015/06/not-ok-google-chromium-voice-extension-pulled-after-spying-concerns/">http://arstechnica.com/security/2015/06/not-ok-google-chromium-voice-extension-pulled-after-spying-concerns/</a>
						</li>
						<li id="ref173">
							173. Mozilla - Firefox - Use the Profile Manager to create and remove Firefox profiles<br>
							<a href="https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles">https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles</a>
						</li>
						<li id="ref174">
							174. Google Code - crypto-js library<br>
							<a href="https://code.google.com/p/crypto-js/">https://code.google.com/p/crypto-js/</a>
						</li>
						<li id="ref175">
							175. HTML5 Rocks - The Basics of Web Workers<br>
							<a href="http://www.html5rocks.com/en/tutorials/workers/basics/">http://www.html5rocks.com/en/tutorials/workers/basics/</a>
						</li>
						<li id="ref176">
							176. Wikipedia - Blocking (computing)<br>
							<a href="https://en.wikipedia.org/wiki/Blocking_(computing)">https://en.wikipedia.org/wiki/Blocking_(computing)</a>
						</li>
						<li id="ref177">
							177. Wikipedia - Cross-origin resource sharing<br>
							<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">https://en.wikipedia.org/wiki/Cross-origin_resource_sharing</a>
						</li>
						<li id="ref178">
							178. Wikipedia - Node.js<br>
							<a href="https://en.wikipedia.org/wiki/Node.js">https://en.wikipedia.org/wiki/Node.js</a>
						</li>
						<li id="ref179">
							179. Wikipedia - SQL injection<br>
							<a href="https://en.wikipedia.org/wiki/SQL_injection">https://en.wikipedia.org/wiki/SQL_injection</a>
						</li>
						<li id="ref180">
							180. Wikipedia - Metadata - Telecommunications<br>
							<a href="https://en.wikipedia.org/wiki/Metadata#Telecommunications">https://en.wikipedia.org/wiki/Metadata#Telecommunications</a>
						</li>
						<li id="ref181">
							181. Wikipedia - Ajax (programming)<br>
							<a href="">https://en.wikipedia.org/wiki/Ajax_(programming)</a>
						</li>
						<li id="ref182">
							182. Wikipedia - ASCII - ASCII printable characters<br>
							<a href="https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters">https://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters</a>
						</li>
						<li id="ref183">
							183. Wikipedia - ISO basic Latin alphabet - Alphabets containing the same set of letters<br>
							<a href="https://en.wikipedia.org/wiki/ISO_basic_Latin_alphabet#Alphabets_containing_the_same_set_of_letters">https://en.wikipedia.org/wiki/ISO_basic_Latin_alphabet#Alphabets_containing_the_same_set_of_letters</a>
						</li>
						<li id="ref184">
							184. Wikipedia - Diacritic<br>
							<a href="https://en.wikipedia.org/wiki/Diacritic">https://en.wikipedia.org/wiki/Diacritic</a>
						</li>
						<li id="ref185">
							185. Wikipedia - UTF-8<br>
							<a href="https://en.wikipedia.org/wiki/UTF-8">https://en.wikipedia.org/wiki/UTF-8</a>
						</li>
						<li id="ref186">
							186. Wikipedia - Hexadecimal<br>
							<a href="https://en.wikipedia.org/wiki/Hexadecimal">https://en.wikipedia.org/wiki/Hexadecimal</a>
						</li>
						<li id="ref187">
							187. Journal of Computer and System Sciences - Volume 18, Issue 2, Pages 143&ndash;154 - J.Lawrence Carter, Mark N. Wegman - Universal classes of hash functions<br>
							<a href="https://www.sciencedirect.com/science/article/pii/0022000079900448">https://www.sciencedirect.com/science/article/pii/0022000079900448</a>
						</li>
						<li id="ref188">
							188. Wikipedia - Nibble<br>
							<a href="https://en.wikipedia.org/wiki/Nibble">https://en.wikipedia.org/wiki/Nibble</a>
						</li>
						<li id="ref189">
							189. Wikipedia - Octet (computing)<br>
							<a href="https://en.wikipedia.org/wiki/Octet_(computing)">https://en.wikipedia.org/wiki/Octet_(computing)</a>
						</li>
						<li id="ref190">
							190. Wikipedia - Twitter - Tweets<br>
							<a href="https://en.wikipedia.org/wiki/Twitter#Tweets">https://en.wikipedia.org/wiki/Twitter#Tweets</a>
						</li>
						<li id="ref191">
							191. Wikipedia - Short Message Service<br>
							<a href="https://en.wikipedia.org/wiki/Short_Message_Service">https://en.wikipedia.org/wiki/Short_Message_Service</a>
						</li>
						<li id="ref192">
							192. Wikipedia - Year 2038 problem<br>
							<a href="https://en.wikipedia.org/wiki/Year_2038_problem">https://en.wikipedia.org/wiki/Year_2038_problem</a>
						</li>
						<li id="ref">
							193. Wikipedia - Russian copulation<br>
							<a href="https://en.wikipedia.org/wiki/Russian_copulation">https://en.wikipedia.org/wiki/Russian_copulation</a>
						</li>
						<li id="ref194">
							194. Dirk Rijmenants' Cipher Machines and Cryptology - One-time Pad - Definition of One-time pad<br>
							<a href="http://users.telenet.be/d.rijmenants/en/onetimepad.htm">http://users.telenet.be/d.rijmenants/en/onetimepad.htm</a>
						</li>
						<li id="ref195">
							195. Wikipedia - Bit-flipping attack<br>
							<a href="https://en.wikipedia.org/wiki/Bit-flipping_attack">https://en.wikipedia.org/wiki/Bit-flipping_attack</a>
						</li>
						<li id="ref196">
							196. StackExchange - Cryptography - What security do Cryptographic Sponges offer against generic quantum attacks?<br>
							<a href="https://crypto.stackexchange.com/questions/419/what-security-do-cryptographic-sponges-offer-against-generic-quantum-attacks/10544#10544">https://crypto.stackexchange.com/questions/419/what-security-do-cryptographic-sponges-offer-against-generic-quantum-attacks/10544#10544</a>
						</li>
						<li id="ref197">
							197. Wikipedia - Hash-based message authentication code<br>
							<a href="https://en.wikipedia.org/wiki/Hash-based_message_authentication_code">https://en.wikipedia.org/wiki/Hash-based_message_authentication_code</a>
						</li>
						<li id="ref198">
							198. Wikipedia - Merkle–Damgård construction<br>
							<a href="https://en.wikipedia.org/wiki/Merkle-Damgard_construction">https://en.wikipedia.org/wiki/Merkle-Damgard_construction</a>
						</li>
						<li id="ref199">
							199. StackExchange - Cryptography - Can Skein be used as a secure MAC in format H(k || m)?<br>
							<a href="https://crypto.stackexchange.com/questions/15813/can-skein-be-used-as-a-secure-mac-in-format-hk-m/15815#15815">https://crypto.stackexchange.com/questions/15813/can-skein-be-used-as-a-secure-mac-in-format-hk-m/15815#15815</a>
						</li>
						<li id="ref200">
							200. StackExchange - Cryptography - Is HMAC needed for a SHA-3 based MAC?<br>
							<a href="https://crypto.stackexchange.com/questions/17735/is-hmac-needed-for-a-sha-3-based-mac">https://crypto.stackexchange.com/questions/17735/is-hmac-needed-for-a-sha-3-based-mac</a>
						</li>
						<li id="ref201">
							201. Mozilla Developer Network - Number.MAX_SAFE_INTEGER<br>
							<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER</a>
						</li>
						<li id="ref202">
							202. Wikipedia - Off-the-Record Messaging<br>
							<a href="https://en.wikipedia.org/wiki/Off-the-Record_Messaging">https://en.wikipedia.org/wiki/Off-the-Record_Messaging</a>
						</li>
						<li id="ref203">
							203. Wikipedia - Three-letter acronym - Examples<br>
							<a href="https://en.wikipedia.org/wiki/Three-letter_acronym#Examples">https://en.wikipedia.org/wiki/Three-letter_acronym#Examples</a>
						</li>
						<li id="ref204">
							204. Wikipedia - Duress code - Military usage<br>
							<a href="https://en.wikipedia.org/wiki/Duress_code#Military_usage">https://en.wikipedia.org/wiki/Duress_code#Military_usage</a>
						</li>
						<li id="ref205">
							205. Wikipedia - Social engineering (security)<br>
							<a href="https://en.wikipedia.org/wiki/Social_engineering_(computer_security)">https://en.wikipedia.org/wiki/Social_engineering_(computer_security)</a>
						</li>
						<li id="ref206">
							206. Wikipedia - Live CD<br>
							<a href="https://en.wikipedia.org/wiki/Live_CD">https://en.wikipedia.org/wiki/Live_CD</a>
						</li>
						<li id="ref207">
							207. Wikipedia - Denial-of-service attack<br>
							<a href="https://en.wikipedia.org/wiki/Denial-of-service_attack">https://en.wikipedia.org/wiki/Denial-of-service_attack</a>
						</li>
						<li id="ref208">
							208. Wikipedia - Secure Shell<br>
							<a href="https://en.wikipedia.org/wiki/Secure_Shell">https://en.wikipedia.org/wiki/Secure_Shell</a>
						</li>
						<li id="ref209">
							209. Wikipedia - SOCKS<br>
							<a href="https://en.wikipedia.org/wiki/SOCKS">https://en.wikipedia.org/wiki/SOCKS</a>
						</li>
						<li id="ref210">
							210. StackExchange - Security - Is it possible for a phone to be transmitting even while turned off and the battery removed?<br>
							<a href="http://security.stackexchange.com/questions/65382/is-it-possible-for-a-phone-to-be-transmitting-even-while-turned-off-and-the-batt/65455#65455">http://security.stackexchange.com/questions/65382/is-it-possible-for-a-phone-to-be-transmitting-even-while-turned-off-and-the-batt/65455#65455</a>
						</li>
						<li id="ref211">
							211. Tor Project - Anonymity Online<br>
							<a href="https://www.torproject.org">https://www.torproject.org</a>
						</li>
						<li id="ref212">
							212. Tails - Privacy for anyone anywhere<br>
							<a href="https://tails.boum.org/">https://tails.boum.org/</a>
						</li>
						<li id="ref213">
							213. Wikipedia - Rubber-hose cryptanalysis<br>
							<a href="https://en.wikipedia.org/wiki/Rubber-hose_cryptanalysis">https://en.wikipedia.org/wiki/Rubber-hose_cryptanalysis</a>
						</li>
						<li id="ref214">
							214. xkcd - Security<br>
							<a href="https://xkcd.com/538/">https://xkcd.com/538/</a>
						</li>
					</ul>
				</div>
				<div class="clear"></div>
			</div>
		</div>
		
		<div class="footer">
			<ul class="links">
				<li>
					<a href="index.html">Home</a>
				</li>
				<li>-</li>
				<li>
					<a href="information.html">Technical design</a>
				</li>
				<li>-</li>
				<li>
					<a href="download.html">Download</a>
				</li>
				<li>-</li>
				<li>
					<a href="https://github.com/joshua-m-david/jerichoencryption">Source code</a>
				</li>				
				<li>-</li>
				<li>
					<a href="installation.html">How to install</a>
				</li>
				<li>-</li>
				<li>
					<a href="usage.html">How to use</a>
				</li>
				<li>-</li>
				<li>
					<a href="faq.html">FAQ</a>
				</li>
			</ul>
			<div class="donate">
				Want to support the project?<br>
				Bitcoin: <code>16h8K8sXCobL5u7wKRPG95F8XAc735P8TM</code><br>
				Litecoin: <code>Ld2X3Uyknq87GktF38q2ZQopyevRwC4hji</code>
			</div>
			<div class="copyright">
				Copyright &copy; 2013 - 2015 Joshua M. David
			</div>
		</div>
	</body>
</html>
